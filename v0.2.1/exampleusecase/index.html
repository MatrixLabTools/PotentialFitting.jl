<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example Use Case · PotentialFitting.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PotentialFitting.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../install/">Install</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../use/">Fitting Potential</a></li><li class="is-active"><a class="tocitem" href>Example Use Case</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Fitting-Potential-1"><span>Fitting Potential</span></a></li><li class="toplevel"><a class="tocitem" href="#Preparing-CP2K-input-files-1"><span>Preparing CP2K input files</span></a></li><li><a class="tocitem" href="#Geometry-inputs-1"><span>Geometry inputs</span></a></li><li><a class="tocitem" href="#CP2K-input-file-1"><span>CP2K input file</span></a></li><li class="toplevel"><a class="tocitem" href="#Molecular-dynamics-1"><span>Molecular dynamics</span></a></li><li><a class="tocitem" href="#IR-spectrum-calculation-1"><span>IR spectrum calculation</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Example Use Case</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example Use Case</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MatrixLabTools/PotentialFitting.jl/blob/master/docs/src/exampleusecase.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Overview-of-example-use-1"><a class="docs-heading-anchor" href="#Overview-of-example-use-1">Overview of example use</a><a class="docs-heading-anchor-permalink" href="#Overview-of-example-use-1" title="Permalink"></a></h1><p>This is an example workflow for doing the whole calculation, except calculating potential itself that has been explained else where.</p><p>Molecular dynamics itself consist of 4 phases:</p><ul><li>Equilibration of initial geometry in gas phase</li><li>Condensing gas to solid.</li><li>Equilibration to DFT</li><li>Spectrum calculation</li></ul><h1 id="Fitting-Potential-1"><a class="docs-heading-anchor" href="#Fitting-Potential-1">Fitting Potential</a><a class="docs-heading-anchor-permalink" href="#Fitting-Potential-1" title="Permalink"></a></h1><p>First we need to fit a potential. In this example we fit a potential for trans-formic acid and argon. <a href="https://github.com/MatrixLabTools/PotentialDB.jl">PotentialDB</a> has pre calculated data than we can use for fitting the potential.</p><pre><code class="language-julia">using PotentialDB
r = defaultregistry()
data = loadpotential(r, &quot;4&quot;)</code></pre><pre><code class="language-none">Dict{String,Any} with 6 entries:
  &quot;Method&quot;   =&gt; &quot;CCSD(T)-F12/RI&quot;
  &quot;cluster2&quot; =&gt; Cluster{AtomOnlySymbol} of 1 atoms
  &quot;Energy&quot;   =&gt; [0.0172099 0.0232891 … 0.0210108 0.0160872; 0.0104979 0.0147825…
  &quot;Points&quot;   =&gt; Cluster{AtomOnlySymbol}[Cluster{AtomOnlySymbol} of 6 atoms Clus…
  &quot;cluster1&quot; =&gt; Cluster{AtomOnlySymbol} of 5 atoms
  &quot;Basis&quot;    =&gt; &quot;cc-pVDZ-F12 cc-pVDZ-F12-CABS cc-pVTZ/C TIGHTSCF&quot;</code></pre><p>The fitting procedure is the same as explained in <a href="../use/#Usage-1">Usage</a> section.</p><p>First we create a potential for fitting.</p><pre><code class="language-julia">using PotentialFitting, PotentialCalculation

m1=MoleculeIdenticalInformation{AtomOnlySymbol}(data[&quot;cluster1&quot;].atoms)
m2=MoleculeIdenticalInformation{AtomOnlySymbol}(data[&quot;cluster2&quot;].atoms)

mpp = MoleculePairPotential(m1,m2, GeneralPowers(-6,-8,-10,-12,-7,-9,-11))</code></pre><pre><code class="language-none">Molecule Pair Potential
Molecule 1 has 5 atoms (5 unique) 
Molecule 2 has 1 atoms (1 unique) 

Potential topology:

r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  1C :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  2O :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  3O :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  4H :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  5H :  6Ar
</code></pre><p>Then we prepare fitting data and apply some constrains. The reason why we applying constrains is that our potential is under fitting and as a result depends heavily on the constrains. You can verify this, by taking constrains off and comparing to constrained potential, or by changing the constrains considerably.</p><pre><code class="language-julia">fdata = FitData(mpp, data[&quot;Points&quot;], data[&quot;Energy&quot;])

setweight_e_more!(fdata, 0.1, 1000)
setweight_e_more!(fdata, 0.01, 5000)
setweight_e_less!(fdata, 2, -50)
setweight_e_less!(fdata, 4, -75)
setweight_e_less!(fdata, 16, -100);</code></pre><p>Then we prepare fitting tools for fitting. Linear regression is most likely good enough. But you can also try support vector machines or ridge regression etc.</p><pre><code class="language-julia">using ScikitLearn
@sk_import linear_model: LinearRegression

model = LinearRegression(fit_intercept=false)</code></pre><pre><code class="language-none">PyObject LinearRegression(copy_X=True, fit_intercept=False, n_jobs=1, normalize=False)</code></pre><p>Fitting potential.</p><pre><code class="language-julia">fit_potential!(model, mpp, fdata)</code></pre><pre><code class="language-none">Molecule Pair Potential
Molecule 1 has 5 atoms (5 unique) 
Molecule 2 has 1 atoms (1 unique) 

Potential topology:

r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** -22540.021826685817  -5.243549549254128e6  -3.2406584939854663e7  1.5153599200877088e8  551050.9158835679  2.2664750821113523e7  -5.313204935446245e7   :  1C :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 13739.083816309227  5.471838960588985e6  1.6957305511660287e8  3.7516844784328675e8  -416048.4665519652  -3.998370710003716e7  -3.89843295245451e8   :  2O :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 9793.326627787901  3.1394019939679718e6  7.627842500369161e7  1.3069576652652234e8  -268179.88211563753  -2.0305101910751928e7  -1.5502947628932872e8   :  3O :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** -2432.161794484593  -633286.4449792223  -1.0427110576785028e7  -1.0703348139907856e7  60921.18783964199  3.4584354828949333e6  1.64817021283349e7   :  4H :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 4525.254251613282  858980.445925096  7.2762912901483355e6  -3.206484077195283e6  -99340.84360449202  -3.6312235994796865e6  -4.349257678219102e6   :  5H :  6Ar
</code></pre><p>Check root mean square deviation for potential.</p><pre><code class="language-julia">rmsd(data[&quot;Points&quot;], data[&quot;Energy&quot;], mpp, emax=-10)</code></pre><pre><code class="language-none">8.367955631368698</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>We are under fitting our potential, so we can safely compare the potential to the data we used for the fitting. But it would be a good idea to confirm this, by comparing to some data that was not used for fitting.</p></div></div><p>To inspect the potential we can use use <code>plot_compare</code> which will calculate potential for given points. Here we visualize one line from potential.</p><pre><code class="language-julia">plot_compare(data[&quot;Points&quot;][:,30], data[&quot;Energy&quot;][:,30], mpp, leg=true)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800" height="400" viewBox="0 0 3200 1600">
<defs>
  <clipPath id="clip970">
    <rect x="0" y="0" width="3200" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip970)" d="
M0 1600 L3200 1600 L3200 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip971">
    <rect x="640" y="0" width="2241" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip970)" d="
M110.74 1505.26 L3152.76 1505.26 L3152.76 47.2441 L110.74 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip972">
    <rect x="110" y="47" width="3043" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip972)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  416.545,1505.26 416.545,47.2441 
  "/>
<polyline clip-path="url(#clip972)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  983.328,1505.26 983.328,47.2441 
  "/>
<polyline clip-path="url(#clip972)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1550.11,1505.26 1550.11,47.2441 
  "/>
<polyline clip-path="url(#clip972)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2116.89,1505.26 2116.89,47.2441 
  "/>
<polyline clip-path="url(#clip972)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2683.68,1505.26 2683.68,47.2441 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  110.74,1505.26 3152.76,1505.26 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  416.545,1505.26 416.545,1487.76 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  983.328,1505.26 983.328,1487.76 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1550.11,1505.26 1550.11,1487.76 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2116.89,1505.26 2116.89,1487.76 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2683.68,1505.26 2683.68,1487.76 
  "/>
<path clip-path="url(#clip970)" d="M 0 0 M427.164 1587.95 Q435.555 1589.75 440.243 1595.42 Q444.988 1601.09 444.988 1609.42 Q444.988 1622.21 436.192 1629.22 Q427.396 1636.22 411.192 1636.22 Q405.752 1636.22 399.965 1635.12 Q394.236 1634.08 388.102 1631.94 L388.102 1620.65 Q392.963 1623.49 398.75 1624.93 Q404.537 1626.38 410.845 1626.38 Q421.84 1626.38 427.569 1622.04 Q433.356 1617.7 433.356 1609.42 Q433.356 1601.79 427.974 1597.5 Q422.65 1593.16 413.102 1593.16 L403.033 1593.16 L403.033 1583.56 L413.565 1583.56 Q422.187 1583.56 426.759 1580.14 Q431.331 1576.67 431.331 1570.19 Q431.331 1563.53 426.586 1560 Q421.898 1556.42 413.102 1556.42 Q408.299 1556.42 402.801 1557.46 Q397.303 1558.5 390.706 1560.7 L390.706 1550.28 Q397.361 1548.43 403.148 1547.5 Q408.993 1546.58 414.144 1546.58 Q427.454 1546.58 435.208 1552.65 Q442.963 1558.67 442.963 1568.97 Q442.963 1576.15 438.854 1581.13 Q434.745 1586.04 427.164 1587.95 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M990.851 1558.32 L961.338 1604.45 L990.851 1604.45 L990.851 1558.32 M987.784 1548.14 L1002.48 1548.14 L1002.48 1604.45 L1014.81 1604.45 L1014.81 1614.17 L1002.48 1614.17 L1002.48 1634.54 L990.851 1634.54 L990.851 1614.17 L951.847 1614.17 L951.847 1602.88 L987.784 1548.14 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1525.81 1548.14 L1571.7 1548.14 L1571.7 1557.98 L1536.51 1557.98 L1536.51 1579.16 Q1539.06 1578.29 1541.6 1577.89 Q1544.15 1577.42 1546.7 1577.42 Q1561.16 1577.42 1569.61 1585.35 Q1578.06 1593.28 1578.06 1606.82 Q1578.06 1620.77 1569.38 1628.52 Q1560.7 1636.22 1544.9 1636.22 Q1539.46 1636.22 1533.79 1635.29 Q1528.18 1634.37 1522.16 1632.51 L1522.16 1620.77 Q1527.37 1623.6 1532.92 1624.99 Q1538.48 1626.38 1544.67 1626.38 Q1554.68 1626.38 1560.53 1621.11 Q1566.37 1615.85 1566.37 1606.82 Q1566.37 1597.79 1560.53 1592.53 Q1554.68 1587.26 1544.67 1587.26 Q1539.98 1587.26 1535.3 1588.3 Q1530.67 1589.34 1525.81 1591.54 L1525.81 1548.14 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2117.91 1586.68 Q2110.04 1586.68 2105.41 1592.06 Q2100.84 1597.45 2100.84 1606.82 Q2100.84 1616.14 2105.41 1621.58 Q2110.04 1626.96 2117.91 1626.96 Q2125.78 1626.96 2130.35 1621.58 Q2134.98 1616.14 2134.98 1606.82 Q2134.98 1597.45 2130.35 1592.06 Q2125.78 1586.68 2117.91 1586.68 M2141.11 1550.05 L2141.11 1560.7 Q2136.71 1558.61 2132.2 1557.51 Q2127.74 1556.42 2123.35 1556.42 Q2111.77 1556.42 2105.64 1564.23 Q2099.56 1572.04 2098.69 1587.84 Q2102.11 1582.8 2107.26 1580.14 Q2112.41 1577.42 2118.6 1577.42 Q2131.62 1577.42 2139.15 1585.35 Q2146.73 1593.22 2146.73 1606.82 Q2146.73 1620.13 2138.86 1628.17 Q2130.99 1636.22 2117.91 1636.22 Q2102.92 1636.22 2094.99 1624.76 Q2087.06 1613.24 2087.06 1591.43 Q2087.06 1570.94 2096.78 1558.79 Q2106.51 1546.58 2122.88 1546.58 Q2127.28 1546.58 2131.74 1547.45 Q2136.25 1548.31 2141.11 1550.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2655.9 1548.14 L2711.45 1548.14 L2711.45 1553.12 L2680.09 1634.54 L2667.88 1634.54 L2697.39 1557.98 L2655.9 1557.98 L2655.9 1548.14 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1387.88 1692.36 L1397.46 1692.36 L1409.58 1724.7 L1421.78 1692.36 L1431.36 1692.36 L1431.36 1739.88 L1425.09 1739.88 L1425.09 1698.16 L1412.83 1730.75 L1406.37 1730.75 L1394.12 1698.16 L1394.12 1739.88 L1387.88 1739.88 L1387.88 1692.36 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1437.5 1704.24 L1443.35 1704.24 L1443.35 1739.88 L1437.5 1739.88 L1437.5 1704.24 M1437.5 1690.36 L1443.35 1690.36 L1443.35 1697.77 L1437.5 1697.77 L1437.5 1690.36 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1479.13 1718.37 L1479.13 1739.88 L1473.27 1739.88 L1473.27 1718.56 Q1473.27 1713.5 1471.3 1710.98 Q1469.33 1708.47 1465.38 1708.47 Q1460.64 1708.47 1457.9 1711.49 Q1455.16 1714.52 1455.16 1719.74 L1455.16 1739.88 L1449.28 1739.88 L1449.28 1704.24 L1455.16 1704.24 L1455.16 1709.77 Q1457.26 1706.56 1460.1 1704.97 Q1462.96 1703.38 1466.69 1703.38 Q1472.83 1703.38 1475.98 1707.2 Q1479.13 1710.98 1479.13 1718.37 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1512.68 1697.65 L1512.68 1734.6 L1520.44 1734.6 Q1530.28 1734.6 1534.83 1730.14 Q1539.41 1725.69 1539.41 1716.08 Q1539.41 1706.53 1534.83 1702.1 Q1530.28 1697.65 1520.44 1697.65 L1512.68 1697.65 M1506.25 1692.36 L1519.46 1692.36 Q1533.27 1692.36 1539.73 1698.12 Q1546.19 1703.85 1546.19 1716.08 Q1546.19 1728.36 1539.7 1734.12 Q1533.21 1739.88 1519.46 1739.88 L1506.25 1739.88 L1506.25 1692.36 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1552.34 1704.24 L1558.19 1704.24 L1558.19 1739.88 L1552.34 1739.88 L1552.34 1704.24 M1552.34 1690.36 L1558.19 1690.36 L1558.19 1697.77 L1552.34 1697.77 L1552.34 1690.36 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1587.06 1705.29 L1587.06 1710.82 Q1584.58 1709.55 1581.9 1708.91 Q1579.23 1708.28 1576.37 1708.28 Q1572.01 1708.28 1569.81 1709.61 Q1567.65 1710.95 1567.65 1713.63 Q1567.65 1715.66 1569.2 1716.84 Q1570.76 1717.99 1575.48 1719.04 L1577.48 1719.48 Q1583.72 1720.82 1586.33 1723.27 Q1588.97 1725.69 1588.97 1730.05 Q1588.97 1735.01 1585.02 1737.91 Q1581.11 1740.81 1574.23 1740.81 Q1571.37 1740.81 1568.25 1740.23 Q1565.16 1739.69 1561.73 1738.58 L1561.73 1732.53 Q1564.97 1734.22 1568.12 1735.08 Q1571.27 1735.91 1574.36 1735.91 Q1578.5 1735.91 1580.73 1734.5 Q1582.95 1733.07 1582.95 1730.49 Q1582.95 1728.11 1581.33 1726.83 Q1579.74 1725.56 1574.3 1724.38 L1572.26 1723.91 Q1566.82 1722.76 1564.4 1720.4 Q1561.98 1718.02 1561.98 1713.88 Q1561.98 1708.85 1565.54 1706.11 Q1569.11 1703.38 1575.67 1703.38 Q1578.91 1703.38 1581.78 1703.85 Q1584.64 1704.33 1587.06 1705.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1600.91 1694.11 L1600.91 1704.24 L1612.97 1704.24 L1612.97 1708.79 L1600.91 1708.79 L1600.91 1728.14 Q1600.91 1732.5 1602.08 1733.74 Q1603.29 1734.98 1606.95 1734.98 L1612.97 1734.98 L1612.97 1739.88 L1606.95 1739.88 Q1600.17 1739.88 1597.6 1737.37 Q1595.02 1734.82 1595.02 1728.14 L1595.02 1708.79 L1590.72 1708.79 L1590.72 1704.24 L1595.02 1704.24 L1595.02 1694.11 L1600.91 1694.11 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1635.31 1721.96 Q1628.22 1721.96 1625.48 1723.59 Q1622.74 1725.21 1622.74 1729.13 Q1622.74 1732.24 1624.78 1734.09 Q1626.85 1735.91 1630.38 1735.91 Q1635.25 1735.91 1638.18 1732.47 Q1641.14 1729 1641.14 1723.27 L1641.14 1721.96 L1635.31 1721.96 M1646.99 1719.55 L1646.99 1739.88 L1641.14 1739.88 L1641.14 1734.47 Q1639.13 1737.72 1636.14 1739.28 Q1633.15 1740.81 1628.82 1740.81 Q1623.35 1740.81 1620.1 1737.75 Q1616.88 1734.66 1616.88 1729.51 Q1616.88 1723.49 1620.89 1720.44 Q1624.94 1717.38 1632.93 1717.38 L1641.14 1717.38 L1641.14 1716.81 Q1641.14 1712.77 1638.46 1710.57 Q1635.82 1708.34 1631.02 1708.34 Q1627.96 1708.34 1625.06 1709.07 Q1622.17 1709.81 1619.49 1711.27 L1619.49 1705.86 Q1622.71 1704.62 1625.73 1704.01 Q1628.76 1703.38 1631.62 1703.38 Q1639.36 1703.38 1643.17 1707.39 Q1646.99 1711.4 1646.99 1719.55 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1682.77 1718.37 L1682.77 1739.88 L1676.91 1739.88 L1676.91 1718.56 Q1676.91 1713.5 1674.94 1710.98 Q1672.97 1708.47 1669.02 1708.47 Q1664.28 1708.47 1661.54 1711.49 Q1658.8 1714.52 1658.8 1719.74 L1658.8 1739.88 L1652.91 1739.88 L1652.91 1704.24 L1658.8 1704.24 L1658.8 1709.77 Q1660.9 1706.56 1663.74 1704.97 Q1666.6 1703.38 1670.32 1703.38 Q1676.47 1703.38 1679.62 1707.2 Q1682.77 1710.98 1682.77 1718.37 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1714.57 1705.6 L1714.57 1711.08 Q1712.08 1709.71 1709.57 1709.04 Q1707.09 1708.34 1704.54 1708.34 Q1698.84 1708.34 1695.69 1711.97 Q1692.54 1715.57 1692.54 1722.09 Q1692.54 1728.62 1695.69 1732.24 Q1698.84 1735.84 1704.54 1735.84 Q1707.09 1735.84 1709.57 1735.17 Q1712.08 1734.47 1714.57 1733.1 L1714.57 1738.52 Q1712.12 1739.66 1709.47 1740.23 Q1706.86 1740.81 1703.9 1740.81 Q1695.85 1740.81 1691.11 1735.75 Q1686.37 1730.69 1686.37 1722.09 Q1686.37 1713.37 1691.14 1708.37 Q1695.95 1703.38 1704.29 1703.38 Q1706.99 1703.38 1709.57 1703.95 Q1712.15 1704.49 1714.57 1705.6 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1751.2 1720.6 L1751.2 1723.46 L1724.27 1723.46 Q1724.66 1729.51 1727.9 1732.69 Q1731.18 1735.84 1737 1735.84 Q1740.38 1735.84 1743.53 1735.01 Q1746.71 1734.19 1749.83 1732.53 L1749.83 1738.07 Q1746.68 1739.41 1743.37 1740.11 Q1740.06 1740.81 1736.65 1740.81 Q1728.12 1740.81 1723.13 1735.84 Q1718.16 1730.88 1718.16 1722.41 Q1718.16 1713.66 1722.87 1708.53 Q1727.62 1703.38 1735.64 1703.38 Q1742.83 1703.38 1747 1708.02 Q1751.2 1712.64 1751.2 1720.6 M1745.34 1718.88 Q1745.28 1714.07 1742.64 1711.21 Q1740.03 1708.34 1735.7 1708.34 Q1730.8 1708.34 1727.84 1711.11 Q1724.91 1713.88 1724.46 1718.91 L1745.34 1718.88 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1798.24 1690.36 L1811.74 1690.36 L1811.74 1694.91 L1804.1 1694.91 L1804.1 1743.93 L1811.74 1743.93 L1811.74 1748.48 L1798.24 1748.48 L1798.24 1690.36 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1838.86 1688.13 Q1838.86 1686.13 1837.42 1684.72 Q1836.02 1683.29 1834.02 1683.29 Q1831.98 1683.29 1830.58 1684.69 Q1829.21 1686.06 1829.21 1688.13 Q1829.21 1690.14 1830.61 1691.54 Q1832.01 1692.94 1834.02 1692.94 Q1836.02 1692.94 1837.42 1691.54 Q1838.86 1690.14 1838.86 1688.13 M1834.02 1698.7 L1825.36 1722.35 L1842.71 1722.35 L1834.02 1698.7 M1829.21 1695.42 Q1827.27 1694.11 1826.28 1692.3 Q1825.3 1690.45 1825.3 1688.13 Q1825.3 1684.47 1827.81 1681.92 Q1830.36 1679.38 1834.02 1679.38 Q1837.65 1679.38 1840.19 1681.96 Q1842.77 1684.5 1842.77 1688.13 Q1842.77 1690.36 1841.75 1692.24 Q1840.77 1694.11 1838.86 1695.42 L1855.79 1739.88 L1849.11 1739.88 L1844.78 1727.69 L1823.36 1727.69 L1819.03 1739.88 L1812.25 1739.88 L1829.21 1695.42 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M1875.62 1690.36 L1875.62 1748.48 L1862.12 1748.48 L1862.12 1743.93 L1869.73 1743.93 L1869.73 1694.91 L1862.12 1694.91 L1862.12 1690.36 L1875.62 1690.36 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip972)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  110.74,1191.51 3152.76,1191.51 
  "/>
<polyline clip-path="url(#clip972)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  110.74,848.902 3152.76,848.902 
  "/>
<polyline clip-path="url(#clip972)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  110.74,506.292 3152.76,506.292 
  "/>
<polyline clip-path="url(#clip972)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  110.74,163.682 3152.76,163.682 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  110.74,1505.26 110.74,47.2441 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  110.74,1191.51 147.244,1191.51 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  110.74,848.902 147.244,848.902 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  110.74,506.292 147.244,506.292 
  "/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  110.74,163.682 147.244,163.682 
  "/>
<path clip-path="url(#clip970)" d="M 0 0 M-210.985 1192.64 L-136.796 1192.64 L-136.796 1202.48 L-210.985 1202.48 L-210.985 1192.64 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-122.097 1224.87 L-103 1224.87 L-103 1158.96 L-123.775 1163.13 L-123.775 1152.48 L-103.115 1148.31 L-91.4257 1148.31 L-91.4257 1224.87 L-72.3286 1224.87 L-72.3286 1234.71 L-122.097 1234.71 L-122.097 1224.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-34.6552 1156.01 Q-43.6829 1156.01 -48.2546 1164.92 Q-52.7685 1173.77 -52.7685 1191.6 Q-52.7685 1209.36 -48.2546 1218.28 Q-43.6829 1227.13 -34.6552 1227.13 Q-25.5696 1227.13 -21.0557 1218.28 Q-16.484 1209.36 -16.484 1191.6 Q-16.484 1173.77 -21.0557 1164.92 Q-25.5696 1156.01 -34.6552 1156.01 M-34.6552 1146.75 Q-20.1298 1146.75 -12.4909 1158.27 Q-4.7942 1169.72 -4.7942 1191.6 Q-4.7942 1213.42 -12.4909 1224.93 Q-20.1298 1236.39 -34.6552 1236.39 Q-49.1805 1236.39 -56.8773 1224.93 Q-64.5161 1213.42 -64.5161 1191.6 Q-64.5161 1169.72 -56.8773 1158.27 Q-49.1805 1146.75 -34.6552 1146.75 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M32.8792 1156.01 Q23.8515 1156.01 19.2797 1164.92 Q14.7659 1173.77 14.7659 1191.6 Q14.7659 1209.36 19.2797 1218.28 Q23.8515 1227.13 32.8792 1227.13 Q41.9648 1227.13 46.4787 1218.28 Q51.0504 1209.36 51.0504 1191.6 Q51.0504 1173.77 46.4787 1164.92 Q41.9648 1156.01 32.8792 1156.01 M32.8792 1146.75 Q47.4046 1146.75 55.0434 1158.27 Q62.7402 1169.72 62.7402 1191.6 Q62.7402 1213.42 55.0434 1224.93 Q47.4046 1236.39 32.8792 1236.39 Q18.3538 1236.39 10.6571 1224.93 Q3.01826 1213.42 3.01826 1191.6 Q3.01826 1169.72 10.6571 1158.27 Q18.3538 1146.75 32.8792 1146.75 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-144.03 850.03 L-69.8402 850.03 L-69.8402 859.868 L-144.03 859.868 L-144.03 850.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-57.0509 805.702 L-11.1599 805.702 L-11.1599 815.54 L-46.3449 815.54 L-46.3449 836.72 Q-43.7986 835.852 -41.2523 835.447 Q-38.7061 834.984 -36.1598 834.984 Q-21.6923 834.984 -13.2432 842.912 Q-4.7942 850.84 -4.7942 864.382 Q-4.7942 878.329 -13.4747 886.083 Q-22.1552 893.78 -37.9537 893.78 Q-43.3935 893.78 -49.0648 892.854 Q-54.6782 891.928 -60.6967 890.076 L-60.6967 878.329 Q-55.4884 881.164 -49.9328 882.553 Q-44.3773 883.942 -38.1852 883.942 Q-28.1737 883.942 -22.3288 878.676 Q-16.484 873.41 -16.484 864.382 Q-16.484 855.354 -22.3288 850.088 Q-28.1737 844.822 -38.1852 844.822 Q-42.8727 844.822 -47.5602 845.863 Q-52.1898 846.905 -57.0509 849.104 L-57.0509 805.702 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M32.8792 813.398 Q23.8515 813.398 19.2797 822.31 Q14.7659 831.164 14.7659 848.988 Q14.7659 866.755 19.2797 875.667 Q23.8515 884.521 32.8792 884.521 Q41.9648 884.521 46.4787 875.667 Q51.0504 866.755 51.0504 848.988 Q51.0504 831.164 46.4787 822.31 Q41.9648 813.398 32.8792 813.398 M32.8792 804.139 Q47.4046 804.139 55.0434 815.655 Q62.7402 827.114 62.7402 848.988 Q62.7402 870.805 55.0434 882.322 Q47.4046 893.78 32.8792 893.78 Q18.3538 893.78 10.6571 882.322 Q3.01826 870.805 3.01826 848.988 Q3.01826 827.114 10.6571 815.655 Q18.3538 804.139 32.8792 804.139 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M32.8792 470.788 Q23.8515 470.788 19.2797 479.7 Q14.7659 488.555 14.7659 506.379 Q14.7659 524.145 19.2797 533.057 Q23.8515 541.911 32.8792 541.911 Q41.9648 541.911 46.4787 533.057 Q51.0504 524.145 51.0504 506.379 Q51.0504 488.555 46.4787 479.7 Q41.9648 470.788 32.8792 470.788 M32.8792 461.529 Q47.4046 461.529 55.0434 473.045 Q62.7402 484.504 62.7402 506.379 Q62.7402 528.196 55.0434 539.712 Q47.4046 551.17 32.8792 551.17 Q18.3538 551.17 10.6571 539.712 Q3.01826 528.196 3.01826 506.379 Q3.01826 484.504 10.6571 473.045 Q18.3538 461.529 32.8792 461.529 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-57.0509 120.482 L-11.1599 120.482 L-11.1599 130.32 L-46.3449 130.32 L-46.3449 151.5 Q-43.7986 150.632 -41.2523 150.227 Q-38.7061 149.764 -36.1598 149.764 Q-21.6923 149.764 -13.2432 157.692 Q-4.7942 165.621 -4.7942 179.162 Q-4.7942 193.109 -13.4747 200.863 Q-22.1552 208.56 -37.9537 208.56 Q-43.3935 208.56 -49.0648 207.634 Q-54.6782 206.708 -60.6967 204.856 L-60.6967 193.109 Q-55.4884 195.944 -49.9328 197.333 Q-44.3773 198.722 -38.1852 198.722 Q-28.1737 198.722 -22.3288 193.456 Q-16.484 188.19 -16.484 179.162 Q-16.484 170.134 -22.3288 164.868 Q-28.1737 159.602 -38.1852 159.602 Q-42.8727 159.602 -47.5602 160.644 Q-52.1898 161.685 -57.0509 163.884 L-57.0509 120.482 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M32.8792 128.179 Q23.8515 128.179 19.2797 137.091 Q14.7659 145.945 14.7659 163.769 Q14.7659 181.535 19.2797 190.447 Q23.8515 199.301 32.8792 199.301 Q41.9648 199.301 46.4787 190.447 Q51.0504 181.535 51.0504 163.769 Q51.0504 145.945 46.4787 137.091 Q41.9648 128.179 32.8792 128.179 M32.8792 118.919 Q47.4046 118.919 55.0434 130.436 Q62.7402 141.894 62.7402 163.769 Q62.7402 185.586 55.0434 197.102 Q47.4046 208.56 32.8792 208.56 Q18.3538 208.56 10.6571 197.102 Q3.01826 185.586 3.01826 163.769 Q3.01826 141.894 10.6571 130.436 Q18.3538 118.919 32.8792 118.919 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-320.761 1023.81 L-320.761 993.768 L-315.35 993.768 L-315.35 1017.38 L-301.282 1017.38 L-301.282 994.755 L-295.871 994.755 L-295.871 1017.38 L-278.652 1017.38 L-278.652 993.195 L-273.241 993.195 L-273.241 1023.81 L-320.761 1023.81 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-294.757 957.42 L-273.241 957.42 L-273.241 963.276 L-294.566 963.276 Q-299.627 963.276 -302.142 965.25 Q-304.656 967.223 -304.656 971.17 Q-304.656 975.912 -301.632 978.65 Q-298.609 981.387 -293.389 981.387 L-273.241 981.387 L-273.241 987.275 L-308.889 987.275 L-308.889 981.387 L-303.351 981.387 Q-306.566 979.286 -308.157 976.453 Q-309.749 973.589 -309.749 969.865 Q-309.749 963.722 -305.929 960.571 Q-302.142 957.42 -294.757 957.42 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-292.529 920.785 L-289.665 920.785 L-289.665 947.712 Q-283.617 947.33 -280.434 944.084 Q-277.283 940.805 -277.283 934.981 Q-277.283 931.607 -278.111 928.456 Q-278.939 925.273 -280.594 922.154 L-275.055 922.154 Q-273.719 925.305 -273.018 928.615 Q-272.318 931.925 -272.318 935.331 Q-272.318 943.861 -277.283 948.858 Q-282.249 953.823 -290.715 953.823 Q-299.468 953.823 -304.592 949.113 Q-309.749 944.37 -309.749 936.349 Q-309.749 929.156 -305.102 924.987 Q-300.486 920.785 -292.529 920.785 M-294.248 926.642 Q-299.054 926.705 -301.919 929.347 Q-304.783 931.957 -304.783 936.286 Q-304.783 941.187 -302.014 944.147 Q-299.245 947.076 -294.216 947.521 L-294.248 926.642 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-303.415 893.986 Q-303.988 894.972 -304.242 896.15 Q-304.529 897.296 -304.529 898.696 Q-304.529 903.662 -301.282 906.335 Q-298.067 908.977 -292.02 908.977 L-273.241 908.977 L-273.241 914.865 L-308.889 914.865 L-308.889 908.977 L-303.351 908.977 Q-306.598 907.131 -308.157 904.171 Q-309.749 901.211 -309.749 896.978 Q-309.749 896.373 -309.653 895.641 Q-309.589 894.909 -309.43 894.018 L-303.415 893.986 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-291.479 865.531 Q-297.845 865.531 -301.346 868.173 Q-304.847 870.783 -304.847 875.525 Q-304.847 880.236 -301.346 882.878 Q-297.845 885.487 -291.479 885.487 Q-285.145 885.487 -281.644 882.878 Q-278.143 880.236 -278.143 875.525 Q-278.143 870.783 -281.644 868.173 Q-285.145 865.531 -291.479 865.531 M-277.665 859.675 Q-268.562 859.675 -264.138 863.717 Q-259.682 867.759 -259.682 876.098 Q-259.682 879.185 -260.16 881.923 Q-260.605 884.66 -261.56 887.238 L-267.257 887.238 Q-265.857 884.66 -265.189 882.145 Q-264.52 879.631 -264.52 877.021 Q-264.52 871.26 -267.544 868.396 Q-270.536 865.531 -276.615 865.531 L-279.511 865.531 Q-276.36 867.345 -274.801 870.178 Q-273.241 873.011 -273.241 876.957 Q-273.241 883.514 -278.238 887.525 Q-283.235 891.535 -291.479 891.535 Q-299.754 891.535 -304.751 887.525 Q-309.749 883.514 -309.749 876.957 Q-309.749 873.011 -308.189 870.178 Q-306.629 867.345 -303.478 865.531 L-308.889 865.531 L-308.889 859.675 L-277.665 859.675 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-269.931 838.7 Q-263.565 841.182 -261.624 843.537 Q-259.682 845.893 -259.682 849.84 L-259.682 854.518 L-264.584 854.518 L-264.584 851.081 Q-264.584 848.662 -265.73 847.325 Q-266.876 845.988 -271.141 844.365 L-273.814 843.315 L-308.889 857.733 L-308.889 851.526 L-281.007 840.386 L-308.889 829.246 L-308.889 823.04 L-269.931 838.7 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-322.766 755.277 L-322.766 741.782 L-318.215 741.782 L-318.215 749.421 L-269.199 749.421 L-269.199 741.782 L-264.648 741.782 L-264.648 755.277 L-322.766 755.277 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-307.521 709.985 L-302.046 709.985 Q-303.415 712.468 -304.083 714.982 Q-304.783 717.465 -304.783 720.011 Q-304.783 725.708 -301.155 728.859 Q-297.558 732.01 -291.033 732.01 Q-284.509 732.01 -280.88 728.859 Q-277.283 725.708 -277.283 720.011 Q-277.283 717.465 -277.952 714.982 Q-278.652 712.468 -280.021 709.985 L-274.61 709.985 Q-273.464 712.436 -272.891 715.078 Q-272.318 717.687 -272.318 720.648 Q-272.318 728.7 -277.379 733.443 Q-282.44 738.185 -291.033 738.185 Q-299.754 738.185 -304.751 733.411 Q-309.749 728.605 -309.749 720.266 Q-309.749 717.56 -309.176 714.982 Q-308.635 712.404 -307.521 709.985 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-302.046 676.088 Q-305.993 673.891 -307.871 670.836 Q-309.749 667.78 -309.749 663.643 Q-309.749 658.073 -305.834 655.049 Q-301.951 652.025 -294.757 652.025 L-273.241 652.025 L-273.241 657.913 L-294.566 657.913 Q-299.691 657.913 -302.173 659.728 Q-304.656 661.542 -304.656 665.266 Q-304.656 669.817 -301.632 672.459 Q-298.609 675.101 -293.389 675.101 L-273.241 675.101 L-273.241 680.989 L-294.566 680.989 Q-299.723 680.989 -302.173 682.803 Q-304.656 684.618 -304.656 688.405 Q-304.656 692.893 -301.6 695.535 Q-298.577 698.177 -293.389 698.177 L-273.241 698.177 L-273.241 704.065 L-308.889 704.065 L-308.889 698.177 L-303.351 698.177 Q-306.629 696.171 -308.189 693.37 Q-309.749 690.57 -309.749 686.718 Q-309.749 682.835 -307.775 680.13 Q-305.802 677.393 -302.046 676.088 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-320.761 621.597 L-303.033 604.314 L-303.033 610.712 L-315.605 624.716 L-303.033 638.721 L-303.033 645.118 L-320.761 627.836 L-320.761 621.597 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-293.707 601.131 L-293.707 583.976 L-288.487 583.976 L-288.487 601.131 L-293.707 601.131 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-278.652 575.891 L-278.652 565.388 L-314.905 565.388 L-312.613 576.814 L-318.47 576.814 L-320.761 565.452 L-320.761 559.022 L-278.652 559.022 L-278.652 548.519 L-273.241 548.519 L-273.241 575.891 L-278.652 575.891 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M-322.766 528.69 L-264.648 528.69 L-264.648 542.185 L-269.199 542.185 L-269.199 534.578 L-318.215 534.578 L-318.215 542.185 L-322.766 542.185 L-322.766 528.69 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><circle clip-path="url(#clip972)" cx="196.835" cy="566.121" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="262.287" cy="1118.08" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="327.904" cy="1377.94" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="393.665" cy="1464" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="459.556" cy="1451.4" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="525.561" cy="1386.91" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="591.669" cy="1298.86" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="657.869" cy="1203.8" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="724.152" cy="1111.01" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="790.51" cy="1025.26" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="856.936" cy="948.703" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="923.424" cy="881.912" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="989.969" cy="824.615" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1056.57" cy="776.059" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1123.21" cy="735.254" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1189.9" cy="701.156" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1256.62" cy="672.735" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1323.39" cy="649.055" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1390.19" cy="629.295" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1457.02" cy="612.755" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1523.88" cy="598.855" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1590.76" cy="587.12" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1657.68" cy="577.165" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1724.61" cy="568.681" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1791.57" cy="561.415" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1858.55" cy="555.154" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1925.55" cy="549.748" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="1992.57" cy="545.049" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2059.61" cy="540.953" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2126.66" cy="537.37" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2193.72" cy="534.221" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2260.8" cy="531.447" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2327.9" cy="528.993" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2395.01" cy="526.818" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2462.13" cy="524.886" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2529.26" cy="523.165" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2596.4" cy="521.626" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2663.55" cy="520.256" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2730.72" cy="519.022" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2797.89" cy="517.916" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2865.07" cy="516.918" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2932.26" cy="516.019" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="2999.46" cy="515.216" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip972)" cx="3066.66" cy="514.481" r="14" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<polyline clip-path="url(#clip972)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  196.835,88.5087 262.287,783.982 327.904,1157.1 393.665,1329.82 459.556,1380.51 525.561,1359.64 591.669,1299.55 657.869,1220.68 724.152,1135.65 790.51,1051.98 
  856.936,973.818 923.424,903.231 989.969,840.947 1056.57,786.909 1123.21,740.614 1189.9,701.335 1256.62,668.261 1323.39,640.578 1390.19,617.52 1457.02,598.388 
  1523.88,582.562 1590.76,569.503 1657.68,558.75 1724.61,549.907 1791.57,542.644 1858.55,536.682 1925.55,531.79 1992.57,527.776 2059.61,524.481 2126.66,521.775 
  2193.72,519.549 2260.8,517.715 2327.9,516.2 2395.01,514.947 2462.13,513.906 2529.26,513.038 2596.4,512.31 2663.55,511.698 2730.72,511.179 2797.89,510.737 
  2865.07,510.356 2932.26,510.027 2999.46,509.74 3066.66,509.488 
  "/>
<path clip-path="url(#clip970)" d="
M2499.79 277.285 L3051.36 277.285 L3051.36 95.8446 L2499.79 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip970)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2499.79,277.285 3051.36,277.285 3051.36,95.8446 2499.79,95.8446 2499.79,277.285 
  "/>
<circle clip-path="url(#clip970)" cx="2634.99" cy="156.325" r="23" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="5.12"/>
<path clip-path="url(#clip970)" d="M 0 0 M2798.06 141.707 L2798.06 146.637 Q2795.7 144.438 2793.02 143.35 Q2790.35 142.262 2787.34 142.262 Q2781.42 142.262 2778.27 145.896 Q2775.12 149.508 2775.12 156.359 Q2775.12 163.188 2778.27 166.822 Q2781.42 170.433 2787.34 170.433 Q2790.35 170.433 2793.02 169.345 Q2795.7 168.257 2798.06 166.058 L2798.06 170.943 Q2795.61 172.609 2792.85 173.443 Q2790.12 174.276 2787.07 174.276 Q2779.22 174.276 2774.71 169.484 Q2770.19 164.669 2770.19 156.359 Q2770.19 148.026 2774.71 143.234 Q2779.22 138.42 2787.07 138.42 Q2790.17 138.42 2792.9 139.253 Q2795.65 140.063 2798.06 141.707 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2814.31 160.572 Q2809.15 160.572 2807.16 161.753 Q2805.17 162.933 2805.17 165.781 Q2805.17 168.049 2806.65 169.392 Q2808.15 170.711 2810.72 170.711 Q2814.27 170.711 2816.39 168.211 Q2818.55 165.688 2818.55 161.521 L2818.55 160.572 L2814.31 160.572 M2822.81 158.813 L2822.81 173.605 L2818.55 173.605 L2818.55 169.669 Q2817.09 172.031 2814.91 173.165 Q2812.74 174.276 2809.59 174.276 Q2805.61 174.276 2803.25 172.054 Q2800.91 169.808 2800.91 166.058 Q2800.91 161.683 2803.83 159.461 Q2806.77 157.239 2812.58 157.239 L2818.55 157.239 L2818.55 156.822 Q2818.55 153.883 2816.6 152.285 Q2814.68 150.665 2811.19 150.665 Q2808.96 150.665 2806.86 151.197 Q2804.75 151.73 2802.81 152.795 L2802.81 148.859 Q2805.14 147.957 2807.34 147.517 Q2809.54 147.054 2811.63 147.054 Q2817.25 147.054 2820.03 149.97 Q2822.81 152.887 2822.81 158.813 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2827.27 137.586 L2831.53 137.586 L2831.53 173.605 L2827.27 173.605 L2827.27 137.586 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2854.66 148.674 L2854.66 152.656 Q2852.85 151.66 2851.02 151.174 Q2849.22 150.665 2847.37 150.665 Q2843.22 150.665 2840.93 153.304 Q2838.64 155.92 2838.64 160.665 Q2838.64 165.41 2840.93 168.049 Q2843.22 170.665 2847.37 170.665 Q2849.22 170.665 2851.02 170.179 Q2852.85 169.669 2854.66 168.674 L2854.66 172.609 Q2852.88 173.443 2850.95 173.859 Q2849.06 174.276 2846.9 174.276 Q2841.05 174.276 2837.6 170.595 Q2834.15 166.915 2834.15 160.665 Q2834.15 154.322 2837.62 150.688 Q2841.12 147.054 2847.18 147.054 Q2849.15 147.054 2851.02 147.471 Q2852.9 147.864 2854.66 148.674 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2858.69 163.373 L2858.69 147.679 L2862.95 147.679 L2862.95 163.211 Q2862.95 166.892 2864.38 168.744 Q2865.82 170.572 2868.69 170.572 Q2872.14 170.572 2874.13 168.373 Q2876.14 166.174 2876.14 162.378 L2876.14 147.679 L2880.4 147.679 L2880.4 173.605 L2876.14 173.605 L2876.14 169.623 Q2874.59 171.984 2872.53 173.142 Q2870.49 174.276 2867.78 174.276 Q2863.32 174.276 2861 171.498 Q2858.69 168.72 2858.69 163.373 M2869.4 147.054 L2869.4 147.054 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2884.87 137.586 L2889.13 137.586 L2889.13 173.605 L2884.87 173.605 L2884.87 137.586 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2905.38 160.572 Q2900.21 160.572 2898.22 161.753 Q2896.23 162.933 2896.23 165.781 Q2896.23 168.049 2897.71 169.392 Q2899.22 170.711 2901.79 170.711 Q2905.33 170.711 2907.46 168.211 Q2909.61 165.688 2909.61 161.521 L2909.61 160.572 L2905.38 160.572 M2913.87 158.813 L2913.87 173.605 L2909.61 173.605 L2909.61 169.669 Q2908.15 172.031 2905.98 173.165 Q2903.8 174.276 2900.65 174.276 Q2896.67 174.276 2894.31 172.054 Q2891.97 169.808 2891.97 166.058 Q2891.97 161.683 2894.89 159.461 Q2897.83 157.239 2903.64 157.239 L2909.61 157.239 L2909.61 156.822 Q2909.61 153.883 2907.67 152.285 Q2905.75 150.665 2902.25 150.665 Q2900.03 150.665 2897.92 151.197 Q2895.82 151.73 2893.87 152.795 L2893.87 148.859 Q2896.21 147.957 2898.41 147.517 Q2900.61 147.054 2902.69 147.054 Q2908.32 147.054 2911.09 149.97 Q2913.87 152.887 2913.87 158.813 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2922.55 140.318 L2922.55 147.679 L2931.32 147.679 L2931.32 150.989 L2922.55 150.989 L2922.55 165.063 Q2922.55 168.234 2923.41 169.137 Q2924.29 170.04 2926.95 170.04 L2931.32 170.04 L2931.32 173.605 L2926.95 173.605 Q2922.02 173.605 2920.14 171.776 Q2918.27 169.924 2918.27 165.063 L2918.27 150.989 L2915.14 150.989 L2915.14 147.679 L2918.27 147.679 L2918.27 140.318 L2922.55 140.318 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2957.97 159.577 L2957.97 161.66 L2938.38 161.66 Q2938.66 166.058 2941.02 168.373 Q2943.41 170.665 2947.64 170.665 Q2950.1 170.665 2952.39 170.063 Q2954.7 169.461 2956.97 168.257 L2956.97 172.285 Q2954.68 173.257 2952.27 173.767 Q2949.87 174.276 2947.39 174.276 Q2941.19 174.276 2937.55 170.665 Q2933.94 167.054 2933.94 160.896 Q2933.94 154.531 2937.37 150.804 Q2940.82 147.054 2946.65 147.054 Q2951.88 147.054 2954.91 150.433 Q2957.97 153.79 2957.97 159.577 M2953.71 158.327 Q2953.66 154.832 2951.74 152.748 Q2949.84 150.665 2946.7 150.665 Q2943.13 150.665 2940.98 152.679 Q2938.85 154.693 2938.52 158.35 L2953.71 158.327 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2979.5 151.614 L2979.5 137.586 L2983.76 137.586 L2983.76 173.605 L2979.5 173.605 L2979.5 169.716 Q2978.15 172.031 2976.09 173.165 Q2974.06 174.276 2971.19 174.276 Q2966.49 174.276 2963.52 170.526 Q2960.58 166.776 2960.58 160.665 Q2960.58 154.554 2963.52 150.804 Q2966.49 147.054 2971.19 147.054 Q2974.06 147.054 2976.09 148.188 Q2978.15 149.299 2979.5 151.614 M2964.98 160.665 Q2964.98 165.364 2966.9 168.049 Q2968.85 170.711 2972.23 170.711 Q2975.61 170.711 2977.55 168.049 Q2979.5 165.364 2979.5 160.665 Q2979.5 155.966 2977.55 153.304 Q2975.61 150.619 2972.23 150.619 Q2968.85 150.619 2966.9 153.304 Q2964.98 155.966 2964.98 160.665 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip970)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  2533.59,216.805 2736.39,216.805 
  "/>
<path clip-path="url(#clip970)" d="M 0 0 M2770.19 199.525 L2790.05 199.525 L2790.05 203.46 L2774.87 203.46 L2774.87 213.645 L2788.57 213.645 L2788.57 217.58 L2774.87 217.58 L2774.87 234.085 L2770.19 234.085 L2770.19 199.525 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2791.07 208.159 L2795.33 208.159 L2795.33 234.085 L2791.07 234.085 L2791.07 208.159 M2791.07 198.066 L2795.33 198.066 L2795.33 203.46 L2791.07 203.46 L2791.07 198.066 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip970)" d="M 0 0 M2804.01 200.798 L2804.01 208.159 L2812.78 208.159 L2812.78 211.469 L2804.01 211.469 L2804.01 225.543 Q2804.01 228.714 2804.87 229.617 Q2805.75 230.52 2808.41 230.52 L2812.78 230.52 L2812.78 234.085 L2808.41 234.085 Q2803.48 234.085 2801.6 232.256 Q2799.73 230.404 2799.73 225.543 L2799.73 211.469 L2796.6 211.469 L2796.6 208.159 L2799.73 208.159 L2799.73 200.798 L2804.01 200.798 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p><code>scan_compare</code>-command is also available and usually much faster to visualize the fit.</p><pre><code class="language-">scan_compare(data[&quot;Points&quot;], data[&quot;Energy&quot;], mpp, leg=true)</code></pre><p>If you found a place in the potential that is not well fitted and want to know where it is, you can visualize it.</p><ul><li><code>visualize_points</code> This calls external program (defaults to VMD) for visualizations. Does not work with IJulia.</li></ul><p>To call them use</p><pre><code class="language-julia">scan_visualize(data[&quot;Points&quot;])</code></pre><pre><code class="language-julia"># Visualize line 32 using vmd
visualize_points(data[&quot;Points&quot;][:,32], command=&quot;vmd&quot;)</code></pre><h1 id="Preparing-CP2K-input-files-1"><a class="docs-heading-anchor" href="#Preparing-CP2K-input-files-1">Preparing CP2K input files</a><a class="docs-heading-anchor-permalink" href="#Preparing-CP2K-input-files-1" title="Permalink"></a></h1><h2 id="Geometry-inputs-1"><a class="docs-heading-anchor" href="#Geometry-inputs-1">Geometry inputs</a><a class="docs-heading-anchor-permalink" href="#Geometry-inputs-1" title="Permalink"></a></h2><p>First grab your favorite and make two file, one for the molecule/cluster you are studying and one for matrix and save them in PDB-format. Here we have a file for formic acid and an other for argon.</p><pre><code class="language-none">COMPND    UNNAMED
AUTHOR    GENERATED BY OPEN BABEL 2.3.2
HETATM    1  C   tfa     1      42.585  42.840  42.933  1.00  0.00           C
HETATM    2  Oh  tfa     1      43.930  42.838  42.829  1.00  0.00           O
HETATM    3  Oo  tfa     1      42.014  43.738  43.531  1.00  0.00           O
HETATM    4  Ho  tfa     1      44.463  43.543  43.222  1.00  0.00           H
HETATM    5  Hc  tfa     1      42.008  42.039  42.484  1.00  0.00           H
CONECT    1    2    3    5                                            
CONECT    2    1    4                                                 
CONECT    3    1                                                      
CONECT    4    2                                                      
CONECT    5    1                                                      
MASTER        0    0    0    0    0    0    0    0    5    0    5    0
END</code></pre><pre><code class="language-none">COMPND    UNNAMED
AUTHOR    GENERATED BY OPEN BABEL 2.3.2
HETATM    6 AR   LIG     2       1.472  80.636  12.825  1.00  0.00           Ar
MASTER        0    0    0    0    0    0    0    0    1    0    1    0
END</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>You need to have different residue names for QM and MM atoms, here &quot;tfa&quot; (trans-formic acid) and &quot;LIG&quot;. This is demanded by CP2K.</p></div></div><p>You also need to put different identifiers to atoms at this point. Here we have:</p><ul><li><code>Oh</code> : hydroxyl group oxygen</li><li><code>Oo</code> : carbonyl group oxygen</li><li><code>Ho</code> : hydroxyl group hydrogen</li><li><code>Hc</code> : hydrogen connected to carbon</li></ul><p>Next we need to decide initial simulation box size, which depends on number of atoms in simulation. If we have 1000 argon atoms then good initial box size is 86 Å. To put the molecule in box we need extra tools. <a href="http://www.gromacs.org">Gromacs</a> in example has that kind of tools.</p><p>To to put the molecule into the box we use <code>gmx editconf</code> command</p><pre><code class="language-none">gmx editconf -f tfa.pdb -box 8.6 8.6 8.6 -o tfa-b86.pdb</code></pre><p>Here we use 86x86x86 Å box, which is ok when using 1000-matrix atoms. But you can adjust this, depending on how many matrix atoms you have.</p><p>Next we need to add argon atoms into the box. For this we use <code>gmx insert-molecules</code> command</p><pre><code class="language-none">gmx insert-molecules -f tfa-b86.pdb -ci ar.pdb -nmol 1000 -o tfa-ar.pdb</code></pre><p>And now we have the final geometry input.</p><h2 id="CP2K-input-file-1"><a class="docs-heading-anchor" href="#CP2K-input-file-1">CP2K input file</a><a class="docs-heading-anchor-permalink" href="#CP2K-input-file-1" title="Permalink"></a></h2><p>The best way to make CP2K input file is to split the file to several parts and using <code>@include</code>-commands to gather them to one file.</p><p>To do this we make</p><ul><li>MM-potential file</li><li>QM-calculation file</li><li>QMMM-boundary file</li><li>CP2K file to gather</li></ul><p>First we make the MM-potential file.</p><pre><code class="language-none">&amp;MM
    &amp;FORCEFIELD
      &amp;CHARGE
         ATOM Ar
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM C
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM Oo
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM Ho
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM Hc
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM Oh
         CHARGE 0.0
      &amp;END CHARGE

      IGNORE_MISSING_CRITICAL_PARAMS .TRUE.
      &amp;NONBONDED
        # Argon-argon potential from http://www.sklogwiki.org/SklogWiki/index.php/Argon
        &amp;LENNARD-JONES
          ATOMS Ar Ar
          EPSILON [K_e] 125.7
          SIGMA [angstrom] 3.345
          RCUT [angstrom] 9.0
        &amp;END LENNARD-JONES

        # trans Formic acid - argon
        # Just copy the potential terms from potential fit here
        &amp;GENPOT
            atoms Ar C
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES -22540.021633788096  -5.243549409354186e6  -3.2406578590178587e7  1.515360096536201e8  551050.9077903178  2.266474955203762e7  -5.3132065936126545e7
            RCUT [angstrom] 9.0
        &amp;END GENPOT
        &amp;GENPOT
            atoms Ar Oh
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES 13739.083360114846  5.471838619459709e6  1.6957303994470203e8  3.7516840650039065e8  -416048.44688283757  -3.998370403083761e7  -3.898432560739321e8
            RCUT [angstrom] 9.0
        &amp;END GENPOT
        &amp;GENPOT
            atoms Ar Oo
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES 9793.326640804324  3.1394020151115586e6  7.627842607574251e7  1.3069576949556419e8  -268179.8831127547  -2.0305102118835907e7  -1.550294791017888e8
            RCUT [angstrom] 9.0
        &amp;END GENPOT
        &amp;GENPOT
            atoms Ar Ho
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES -2432.1617929808244  -633286.4451121971  -1.042711058845794e7  -1.070334816166878e7  60921.18782589104  3.4584354851854523e6  1.6481702154332923e7
            RCUT [angstrom] 9.0
        &amp;END GENPOT
        &amp;GENPOT
            atoms Ar Hc
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES 4525.254249630937  858980.4449115618  7.2762912659367565e6  -3.2064841129619866e6  -99340.84352925561  -3.6312235927495877e6  -4.349257632528463e6
            RCUT [angstrom] 9.0
        &amp;END GENPOT

      &amp;END NONBONDED

    &amp;END FORCEFIELD
    &amp;POISSON
      PERIODIC XYZ
      # CP2K needs ewald summation section in input. But for us it is useless,
      # and you can put whatever values here.
      &amp;EWALD
        EWALD_TYPE spme
        ALPHA .44
        GMAX  40
      &amp;END EWALD
    &amp;END POISSON

  &amp;END MM</code></pre><p>Then we make a QM-file with semi-empirical calculation method to condense the system. Here we use AM1-method that is fine for formic acid.</p><pre><code class="language-none">&amp;DFT
    BASIS_SET_FILE_NAME ${LIBDIR}/BASIS_MOLOPT
    POTENTIAL_FILE_NAME ${LIBDIR}/POTENTIAL
    &amp;MGRID
      NGRIDS 4
      CUTOFF 350
      REL_CUTOFF 50
    &amp;END MGRID

    &amp;QS
       # We use semi-empirical to condence the system
       METHOD AM1
       &amp;SE
         &amp;COULOMB
           CUTOFF [angstrom] 10.0
         &amp;END
         &amp;EXCHANGE
           CUTOFF [angstrom] 10.0
         &amp;END
      &amp;END
    &amp;END

    &amp;SCF
      SCF_GUESS ATOMIC
      EPS_SCF 1.0E-6         # convergence threshold for total energy
      MAX_SCF 30
      &amp;OUTER_SCF
        MAX_SCF 10
        EPS_SCF 1.0E-6
      &amp;END
    &amp;END SCF

    # Our QM-box is non periodic, so we need a Poison-solver
    &amp;POISSON
      POISSON_SOLVER MT
      PERIODIC NONE
    &amp;END POISSON

&amp;END DFT
</code></pre><p>and a second file for DFT. We use BLYP-D3BJ here.</p><pre><code class="language-none">&amp;DFT
    BASIS_SET_FILE_NAME ${LIBDIR}/BASIS_MOLOPT
    POTENTIAL_FILE_NAME ${LIBDIR}/POTENTIAL
    &amp;MGRID
      NGRIDS 4
      CUTOFF 350
      REL_CUTOFF 50
    &amp;END MGRID

    &amp;QS
       METHOD GPW
       EPS_DEFAULT 1.0E-10
       EXTRAPOLATION ASPC
    &amp;END


    &amp;SCF
      SCF_GUESS ATOMIC
      EPS_SCF 1.0E-6         # convergence threshold for total energy
      MAX_SCF 30
      &amp;OUTER_SCF
        MAX_SCF 10
        EPS_SCF 1.0E-6
      &amp;END
    &amp;END SCF

    &amp;XC
      &amp;XC_FUNCTIONAL BLYP
      &amp;END XC_FUNCTIONAL
      &amp;VDW_POTENTIAL
         POTENTIAL_TYPE PAIR_POTENTIAL
         &amp;PAIR_POTENTIAL
            TYPE DFTD3(BJ)
            R_CUTOFF 16
            REFERENCE_FUNCTIONAL BLYP
            PARAMETER_FILE_NAME ${LIBDIR}/dftd3.dat
         &amp;END
      &amp;END
    &amp;END XC

    &amp;POISSON
      POISSON_SOLVER MT
      PERIODIC NONE
    &amp;END POISSON

&amp;END DFT</code></pre><p>Then we need to make the QM-MM file</p><pre><code class="language-none">&amp;QMMM
    CENTER_GRID TRUE

    # For formic acid 10Å box is enough
    &amp;CELL                    
      ABC [angstrom] 10 10 10
      PERIODIC NONE
    &amp;END CELL

    # Define QM atoms
    &amp;QM_KIND C
      MM_INDEX 1
    &amp;END QM_KIND
    &amp;QM_KIND O
      MM_INDEX 2 3
    &amp;END QM_KIND
    &amp;QM_KIND H
      MM_INDEX 4 5
    &amp;END QM_KIND

    # Apply periodic potential for MM system (default)
    &amp;PERIODIC
      # We can turn multipole off, because argon has no partial charge
      &amp;MULTIPOLE OFF   
      &amp;END
    &amp;END PERIODIC

&amp;END QMMM</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>CENTER_GRID TRUE</code> is very important option. Without it QM system will heat up on its own and calculations will fail.</p></div></div><p>Finally we make a file that gathers all the other files. The idea here is that you only need to edit this file in the future.</p><pre><code class="language-none">@SET SYSTEM equilib
@SET LIBDIR #add path to cp2k-data directory

&amp;GLOBAL
  PROJECT ${SYSTEM}
  PRINT_LEVEL LOW
  RUN_TYPE MD
&amp;END GLOBAL

&amp;FORCE_EVAL
  STRESS_TENSOR ANALYTICAL
  METHOD QMMM

  # These are the files we created previously
  @include qm-am1.inc
  @include mm.inc
  @include qmmm.inc

  &amp;SUBSYS
    &amp;CELL
      # box containing the system,
      # using 86x86x86 box we made earlier for the inputs
      ABC [angstrom] 86 86 86
    &amp;END CELL
    &amp;TOPOLOGY
      COORD_FILE_NAME tfa-ar.pdb
      COORD_FILE_FORMAT PDB
      CONN_FILE_FORMAT USER
      &amp;GENERATE
         &amp;ISOLATED_ATOMS
            # This need to span to all atoms in the simulation
            # We don&#39;t have any unbreakable mm-bonds in simulation
            LIST 1..1005
         &amp;END
      &amp;END
    &amp;END TOPOLOGY
    &amp;KIND Ho
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q1
      ELEMENT H
    &amp;END KIND
    &amp;KIND H                  
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q1
      ELEMENT H
    &amp;END KIND
    &amp;KIND Hc                 
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q1
      ELEMENT H
    &amp;END KIND
    &amp;KIND Oh
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q6
      ELEMENT O
    &amp;END KIND
    &amp;KIND Oo
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q6
      ELEMENT O
    &amp;END KIND
    &amp;KIND O
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q6
      ELEMENT O
    &amp;END KIND
    &amp;KIND C
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q4
    &amp;END KIND
  &amp;END SUBSYS

&amp;END FORCE_EVAL

&amp;MOTION

    &amp;MD
        ENSEMBLE NVT
        TEMPERATURE [K] 80
        TEMP_TOL 50
        TIMESTEP [fs] 0.5
        STEPS 20000
        &amp;THERMOSTAT
            REGION MASSIVE
            TYPE CSVR
            &amp;CSVR
              TIMECON [fs] 100
            &amp;END CSVR
        &amp;END THERMOSTAT
    &amp;END MD

    &amp;PRINT
        &amp;TRAJECTORY
            &amp;EACH
                MD 20
            &amp;END EACH
            FORMAT PDB
        &amp;END TRAJECTORY
        &amp;RESTART_HISTORY
            &amp;EACH
                MD 5000
            &amp;END EACH
        &amp;END RESTART_HISTORY
    &amp;END PRINT

&amp;END MOTION
</code></pre><h1 id="Molecular-dynamics-1"><a class="docs-heading-anchor" href="#Molecular-dynamics-1">Molecular dynamics</a><a class="docs-heading-anchor-permalink" href="#Molecular-dynamics-1" title="Permalink"></a></h1><p>Overview here is to start from gas phase and have the system to condense to solid matrix. To do this the simulation consist of 4 phases.</p><ul><li>Equilibration from initial coordinates to some kind of gas.</li><li>Condensing gas solid.</li><li>Changing calculation method from semi-empirical to DFT and equilibrate it.</li><li>Calculate the spectrum.</li></ul><h3 id="The-first-equilibration-1"><a class="docs-heading-anchor" href="#The-first-equilibration-1">The first equilibration</a><a class="docs-heading-anchor-permalink" href="#The-first-equilibration-1" title="Permalink"></a></h3><p>Aim here is to create a super cooled gas that will compress to solid/liquid in the next phase. To do this we need to set simulation temperature to lower than boiling point. For argon 80 K is a good temperature. This can be done with the input file that was constructed earlier.</p><h3 id="Condensing-1"><a class="docs-heading-anchor" href="#Condensing-1">Condensing</a><a class="docs-heading-anchor-permalink" href="#Condensing-1" title="Permalink"></a></h3><p>To condense the system we need to change the dynamics to NTP, so that the external pressure will compress it. To do it we&#39;ll use following input file</p><pre><code class="language-none">@SET SYSTEM condence
@SET LIBDIR # add path to cp2k-data directory

&amp;GLOBAL
  PROJECT ${SYSTEM}
  PRINT_LEVEL LOW
  RUN_TYPE MD
&amp;END GLOBAL

&amp;FORCE_EVAL
  STRESS_TENSOR ANALYTICAL
  METHOD QMMM


  @include qm-am1.inc
  @include mm.inc
  @include qmmm.inc

  @include subsys.inc


&amp;MOTION

    &amp;MD
        ENSEMBLE NPT_I
        TEMPERATURE [K] 20
        TIMESTEP [fs] 0.5
        STEPS 200000
        &amp;THERMOSTAT
            REGION MASSIVE
            TYPE CSVR
            &amp;CSVR
              TIMECON [fs] 250
            &amp;END CSVR
        &amp;END THERMOSTAT
        &amp;BAROSTAT
             PRESSURE [bar] 1.0
             TEMPERATURE [K] 20
             TEMP_TOL [K] 20
             TIMECON [fs] 250
        &amp;END BAROSTAT
    &amp;END MD

    &amp;PRINT
        &amp;TRAJECTORY
            &amp;EACH
                MD 40
            &amp;END EACH
            FORMAT PDB
        &amp;END TRAJECTORY
        &amp;RESTART_HISTORY
            &amp;EACH
                MD 50000
            &amp;END EACH
        &amp;END RESTART_HISTORY
    &amp;END PRINT

&amp;END MOTION</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The rate at which the system condenses is heavily affected by thermostats coupling constant, here 250 fs. The system will condense slower, if the constant is smaller. 250 fs has proven to be a good value for many different systems.</p></div></div><p>This input file has additional file <code>subsys.inc</code> that includes <code>&amp;SUBSYSTEM</code> section form the previous run. You can get the section by using <code>grep</code> on restart file.</p><pre><code class="language-none">grep -A 10000 &quot;&amp;SUBSYS&quot;</code></pre><p>In this phase we also set the final temperature, now 20 K.</p><h3 id="Change-to-DFT-1"><a class="docs-heading-anchor" href="#Change-to-DFT-1">Change to DFT</a><a class="docs-heading-anchor-permalink" href="#Change-to-DFT-1" title="Permalink"></a></h3><p>Next we&#39;ll change QM calculation method to DFT. To do this we&#39;ll use slightly modified input file from the previous phase</p><pre><code class="language-none">@SET SYSTEM dftequilib
@SET LIBDIR # add path to cp2k-data directory

&amp;GLOBAL
  PROJECT ${SYSTEM}
  PRINT_LEVEL LOW
  RUN_TYPE MD
&amp;END GLOBAL

&amp;FORCE_EVAL
  STRESS_TENSOR ANALYTICAL
  METHOD QMMM


  @include qm-blyp-d3bj.inc
  @include mm.inc
  @include qmmm.inc

  @include condensed_subsys.inc


&amp;MOTION

    &amp;MD
        ENSEMBLE NPT_I
        TEMPERATURE [K] 20
        TIMESTEP [fs] 0.5

        # You can increase this if needed
        STEPS 10000
        &amp;THERMOSTAT
            REGION MASSIVE
            TYPE CSVR
            &amp;CSVR
              # This constant is not that important anymore
              TIMECON [fs] 25
            &amp;END CSVR
        &amp;END THERMOSTAT
        &amp;BAROSTAT
             PRESSURE [bar] 1.0
             TEMPERATURE [K] 20
             TEMP_TOL [K] 20
             TIMECON [fs] 250
        &amp;END BAROSTAT
    &amp;END MD

    &amp;PRINT
        &amp;TRAJECTORY
            &amp;EACH
                MD 40
            &amp;END EACH
            FORMAT PDB
        &amp;END TRAJECTORY
        &amp;RESTART_HISTORY
            &amp;EACH
                MD 5000
            &amp;END EACH
        &amp;END RESTART_HISTORY
    &amp;END PRINT

&amp;END MOTION</code></pre><h2 id="IR-spectrum-calculation-1"><a class="docs-heading-anchor" href="#IR-spectrum-calculation-1">IR spectrum calculation</a><a class="docs-heading-anchor-permalink" href="#IR-spectrum-calculation-1" title="Permalink"></a></h2><p>To calculate spectrum we need dipole moments, to do this we need to add command to print them to our QM-file</p><pre><code class="language-none">&amp;DFT
    BASIS_SET_FILE_NAME ${LIBDIR}/BASIS_MOLOPT
    POTENTIAL_FILE_NAME ${LIBDIR}/POTENTIAL
    &amp;MGRID
      NGRIDS 4
      CUTOFF 350
      REL_CUTOFF 50
    &amp;END MGRID

    &amp;QS
       METHOD GPW
       EPS_DEFAULT 1.0E-10
       EXTRAPOLATION ASPC
    &amp;END


    &amp;SCF
      SCF_GUESS ATOMIC
      EPS_SCF 1.0E-6         # convergence threshold for total energy
      MAX_SCF 30
      &amp;OUTER_SCF
        MAX_SCF 10
        EPS_SCF 1.0E-6
      &amp;END
    &amp;END SCF

    &amp;XC
      &amp;XC_FUNCTIONAL BLYP
      &amp;END XC_FUNCTIONAL
      &amp;VDW_POTENTIAL
         POTENTIAL_TYPE PAIR_POTENTIAL
         &amp;PAIR_POTENTIAL
            TYPE DFTD3(BJ)
            R_CUTOFF 16
            REFERENCE_FUNCTIONAL BLYP
            PARAMETER_FILE_NAME ${LIBDIR}/dftd3.dat
         &amp;END
      &amp;END
    &amp;END XC

    &amp;POISSON
      POISSON_SOLVER MT
      PERIODIC NONE
    &amp;END POISSON

    &amp;PRINT
      &amp;MOMENTS
       PERIODIC FALSE
       &amp;EACH
         MD 1
       &amp;END
       MAX_MOMENT 1
       FILENAME =dipole.traj
      &amp;END MOMENTS
     &amp;END

&amp;END DFT</code></pre><p>We&#39;ll also need to edit input file to change the mode to NVE</p><pre><code class="language-none">@SET SYSTEM spectrum
@SET LIBDIR # add path to cp2k-data directory

&amp;GLOBAL
  PROJECT ${SYSTEM}
  PRINT_LEVEL LOW
  RUN_TYPE MD
&amp;END GLOBAL

&amp;FORCE_EVAL
  STRESS_TENSOR ANALYTICAL
  METHOD QMMM


  @include qm-blyp-d3bj-dipoles.inc
  @include mm.inc
  @include qmmm.inc

  @include dft_subsys.inc


&amp;MOTION

    &amp;MD
        ENSEMBLE NVE
        TIMESTEP [fs] 0.5
        STEPS 80000
    &amp;END MD

    &amp;PRINT
        &amp;TRAJECTORY
            &amp;EACH
                MD 5
            &amp;END EACH
            FORMAT PDB
        &amp;END TRAJECTORY
        &amp;RESTART_HISTORY
            &amp;EACH
                MD 5000
            &amp;END EACH
        &amp;END RESTART_HISTORY
    &amp;END PRINT

&amp;END MOTION</code></pre><p>This will create <code>dipole.traj</code>-file that contains dipole moments. You can use <a href="https://github.com/MatrixLabTools/IRSpectrum.jl">IRSpectrum.jl</a> to calculate IR-spectrum form the dipole trajectory file.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../use/">« Fitting Potential</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 2 March 2021 20:08">Tuesday 2 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
