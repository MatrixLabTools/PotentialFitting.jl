var documenterSearchIndex = {"docs":
[{"location":"exampleusecase/#Running-molecular-dynamics-1","page":"Example use case","title":"Running molecular dynamics","text":"","category":"section"},{"location":"exampleusecase/#Fitting-Potential-1","page":"Example use case","title":"Fitting Potential","text":"","category":"section"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"First fit potential. In this example we fit potential for trans-formic acid and argon.","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"using PotentialDB\nr = defaultregistry()\ndata = loadpotential(r, \"4\")","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"using PotentialFitting, PotentialCalculation\n\nm1=MoleculeIdenticalInformation{AtomOnlySymbol}(data[\"cluster1\"].atoms)\nm2=MoleculeIdenticalInformation{AtomOnlySymbol}(data[\"cluster2\"].atoms)\n\nmpp = MoleculePairPotential(m1,m2, GeneralPowers(-6,-7,-8,-9,-10,-11,-12))","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"fdata = FitData(mpp, data[\"Points\"], data[\"Energy\"])\n\nsetweight_e_more!(fdata, 0.1, 1000)\nsetweight_e_more!(fdata, 0.01, 5000)\nsetweight_e_less!(fdata, 2, -50)\nsetweight_e_less!(fdata, 4, -75)\nsetweight_e_less!(fdata, 16, -100);","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"using ScikitLearn\n@sk_import linear_model: LinearRegression\n\nmodel = LinearRegression()","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"fit_potential!(model, mpp, fdata)","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"rmsd(data[\"Points\"], data[\"Energy\"], mpp, emax=-10)","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"To inspect the potential we can use use","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"plot_compare(data[\"Points\"][:,30], data[\"Energy\"][:,30], mpp, leg=true)","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"scan_compare-command is also available and usually much faster to visualize the fit.","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"scan_compare(data[\"Points\"], data[\"Energy\"], mpp)","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"If you found a place in the potential that is not well fitted and want to know where it is, you can visualize it. There are two options","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"scan_vizualize Uses Bio3DView and needs IJulia (Jupyter notebook) or Blink to work.\nvisualize_points This calls external progam (defaults to VMD) for visualizations. Does not work with IJulia.","category":"page"},{"location":"exampleusecase/#","page":"Example use case","title":"Example use case","text":"visualize_points(data[\"Points\"][:,32])","category":"page"},{"location":"exampleusecase/#Prepare-CP2K-input-files-1","page":"Example use case","title":"Prepare CP2K input files","text":"","category":"section"},{"location":"#PoentialFitting.jl-1","page":"Home","title":"PotentialFitting.jl Documentation","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"","category":"page"},{"location":"#Package-Features-1","page":"Home","title":"Package Features","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Define new potentials easily\nFit potential using methods provided by ScikitLearn","category":"page"},{"location":"#Functions-1","page":"Home","title":"Functions","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"CurrentModule = PotentialFitting","category":"page"},{"location":"#Visualize-1","page":"Home","title":"Visualize","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Modules = [PotentialFitting.visualize]\nOrder   = [:function, :type, :macro]","category":"page"},{"location":"#PotentialFitting.visualize.min_distance-Tuple{MoleculePairPotential,Any}","page":"Home","title":"PotentialFitting.visualize.min_distance","text":"min_distance(mpp::MoleculePairPotential, points)\n\nGives minimum distance of molecules in mpp on given points. Used to help plotting.\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.visualize.plot_compare-Tuple{Any,Any,Vararg{MoleculePairPotential,N} where N}","page":"Home","title":"PotentialFitting.visualize.plot_compare","text":"plot_compare(points, energy, mpp::MoleculePairPotential...; emax=100, unit=\"cm^-1\",                       leg=false, size=(800,400), font=font(20))\n\nCompares fitted energy to calculated one.\n\nArguments\n\npoints  : array of Cluster where potential is plotted\nenergy  : calculated energy\nmpp::MoleculePairPotential...  : potentials to be fitted\nemax=100  : maximum energy in plot - cut all values with energy greater\nunit=\"cm^-1\"  : energy unit\nleg=false     : draw legend\nsize=(800,400)   : size of picture\nfont=font(20)    : font size\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.visualize.plot_potential-Tuple{Any,MoleculePairPotential}","page":"Home","title":"PotentialFitting.visualize.plot_potential","text":"plot_potential(points, mpp::MoleculePairPotential; emax=100, unit=\"cm^-1\",                         leg=false, size=(800,400), font=font(20))\n\nPlots potential\n\nArguments\n\npoints  : array of Cluster where potential is plotted\nmpp::MoleculePairPotential  : potential\nemax=100  : maximum energy in plot - cut all values with energy greater\nunit=\"cm^-1\"  : energy unit\nleg=false     : draw legend\nsize=(800,400)   : size of picture\nfont=font(20)    : font size\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.visualize.scan_compare-Tuple{Any,Any,Vararg{Any,N} where N}","page":"Home","title":"PotentialFitting.visualize.scan_compare","text":"scan_compare(points,energy, mppe...; emax=100, unit=\"cm^-1\",                       leg=false, fsize=(800,400))\n\nUse Interact to view potentials ineractively on different points.\n\nVisualization is done on collumn vise.\n\nArguments\n\npoints  : array of points, first dimension is displayd while second can be chosen\nenergy  : array of reference energy, first dimension is displayd while second can be chosen\nmppe... : MoleculePairPotential which are plotted\nemax=100  : maximum energy in plot - cut all values with energy greater\nunit=\"cm^-1\"  : energy unit\nleg=false     : draw legend\nsize=(800,400)   : size of picture\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.visualize.scan_vizualize-Tuple{Any}","page":"Home","title":"PotentialFitting.visualize.scan_vizualize","text":"scan_vizualize(points; i=4)\n\nVisualize geometry of points interactively using Interact\n\nArguments\n\npoints  : array of points, first dimension is displayd while second can be chosen\ni=4     : row index at with visialization is done\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.visualize.visualize_point_bio3dview-Tuple{Cluster}","page":"Home","title":"PotentialFitting.visualize.visualize_point_bio3dview","text":"visualizepointbio3dview(point::Cluster)\n\nVisualize point using Bio3DView. Can be used wit IJulia and on html\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.visualize.visualize_points-Tuple{Any}","page":"Home","title":"PotentialFitting.visualize.visualize_points","text":"visualize_points(points; stdout=devnull, stderr=devnull, command=\"vmd\")\n\nVisualize using external program.\n\n\n\n\n\n","category":"method"},{"location":"#Fit-1","page":"Home","title":"Fit","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Modules = [PotentialFitting.fit]\nOrder   = [:function, :type, :macro]","category":"page"},{"location":"#PotentialFitting.fit.fit_potential!-Tuple{Any,MoleculePairPotential,FitData}","page":"Home","title":"PotentialFitting.fit.fit_potential!","text":"fit_potential!(model, mpp::MoleculePairPotential, fdata::FitData)\n\nFits potential using given model\n\nArguments\n\nmodel                       : ScikitLearn model\nmpp::MoleculePairPotential  : potential\nfdata::FitData              : data used in fitting\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.fit.predict_potential-Tuple{Any,MoleculePairPotential,Any,Any}","page":"Home","title":"PotentialFitting.fit.predict_potential","text":"predict_potential(model, mpp::MoleculePairPotential, cluster1, cluster2)\n\nUses model to predict potential on given cluster points\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.fit.predict_potential-Tuple{Any,MoleculePairPotential,Any}","page":"Home","title":"PotentialFitting.fit.predict_potential","text":"predict_potential(model, mpp::MoleculePairPotential, points)\n\nUses model to predict potential on given points\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.fit.setweight_e_less!","page":"Home","title":"PotentialFitting.fit.setweight_e_less!","text":"setweightemore!(data::FitData, w, e; unit=\"cm-1\")\n\nSets weigth when energy is more than given one.\n\nArguments\n\ndata::FitData  : data where weigth is adjusted\nw              : new weigth\ne              : energy\nunit=\"cm-1\"    : energy unit\n\n\n\n\n\n","category":"function"},{"location":"#PotentialFitting.fit.setweight_e_more!-Tuple{FitData,Any,Any}","page":"Home","title":"PotentialFitting.fit.setweight_e_more!","text":"setweightemore!(data::FitData, w, e; unit=\"cm-1\")\n\nSets weigth when energy is more than given one.\n\nArguments\n\ndata::FitData  : data where weigth is adjusted\nw              : new weigth\ne              : energy\nunit=\"cm-1\"    : energy unit\n\n\n\n\n\n","category":"method"},{"location":"#StatsBase.rmsd-Tuple{Any,Any,MoleculePairPotential}","page":"Home","title":"StatsBase.rmsd","text":"rmsd(points, energy, mpp::MoleculePairPotential; emax=0, unit=\"cm^-1\")\n\nCalculates root mean square error for potential mpp.\n\nAtributes\n\npoints                      : points where potential is tested\nenergy                      : referece energy for given points\nmpp::MoleculePairPotential  : potential\nemax=0                      : cut points where energy is larger than this\nunit=\"cm^-1\"                : unit for energy\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.fit.FitData","page":"Home","title":"PotentialFitting.fit.FitData","text":"FitData\n\nStructure to help potential parameters fitting.\n\nFields\n\nvariables : variables\nE         : energy\nw         : weights\n\n\n\n\n\n","category":"type"},{"location":"#PotentialFitting.fit.give_as_potential-Tuple{Any,Any}","page":"Home","title":"PotentialFitting.fit.give_as_potential","text":"giveaspotential(T, data)\n\nReturns MoleculePairPotential{T} from given data that must have \"c1_molecule\" and \"c2_molecule\" fields\n\n\n\n\n\n","category":"method"},{"location":"#Potentials-1","page":"Home","title":"Potentials","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Modules = [PotentialFitting.potentials, PotentialFitting.lennardjones, PotentialFitting.generalpowers]\nOrder   = [:function, :type, :macro]","category":"page"},{"location":"#PotentialFitting.potentials.calculate_potential-Tuple{AbstractPairPotential,AbstractCluster,Any}","page":"Home","title":"PotentialFitting.potentials.calculate_potential","text":"calculate_potential(potential::AbstractPotential, cluster::AbstractCluster, indices)\n\nCalculates energy from given potential. Needs to be implemented for each potential.\n\nArguments\n\npotential::AbstractPairPotential  : potential\ncluster::AbstractCluster          : molecule cluster\nindices                           : indices for atoms that represent potential\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.potentials.get_potential!-Tuple{AbstractPotential,Any}","page":"Home","title":"PotentialFitting.potentials.get_potential!","text":"get_potential!(potential, terms)\n\nFunction that sets potential term after potential has been fitted. That is this function transforms fitted term to potential terms. Needs to be implemented for each potential.\n\nArguments\n\npotential : used potential\nterms     : terms from fitting method\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.potentials.potential_variables-Tuple{MoleculePairPotential,Any}","page":"Home","title":"PotentialFitting.potentials.potential_variables","text":"potential_variables(mpp::MoleculePairPotential, points)\n\nUsed to transform cluster data to fittable form.\n\nArguments\n\nmpp::MoleculePairPotential : potential to be fitted\npoints : array for clusters\n\nReturns\n\nArray holding an array for each potential term in mpp.topology that can the be used for fitting.\n\n\n\n\n\n","category":"method"},{"location":"#PotentialFitting.potentials.AbstractClusterPotential","page":"Home","title":"PotentialFitting.potentials.AbstractClusterPotential","text":"AbstractClusterPotential <: AbstractPotential\n\nPotentials between groups of atoms\n\n\n\n\n\n","category":"type"},{"location":"#PotentialFitting.potentials.AbstractPairPotential","page":"Home","title":"PotentialFitting.potentials.AbstractPairPotential","text":"AbstractPairPotential  <: AbstractPotential\n\nPotential that depends only on distance between two atoms\n\n\n\n\n\n","category":"type"},{"location":"#PotentialFitting.potentials.MoleculePairPotential","page":"Home","title":"PotentialFitting.potentials.MoleculePairPotential","text":"MoleculePairPotential{T<:AbstractPairPotential} <: AbstractClusterPotential\n\nStructure to hold potential information between two molecules\n\n\n\n\n\n","category":"type"},{"location":"#PotentialFitting.lennardjones.LennardJones","page":"Home","title":"PotentialFitting.lennardjones.LennardJones","text":"LennardJones <: AbstractPairPotential\n\nHolds constants for Lennard-Jones potential     E = C12/R^12 - C6/R^6\n\n\n\n\n\n","category":"type"},{"location":"#PotentialFitting.generalpowers.GeneralPowers","page":"Home","title":"PotentialFitting.generalpowers.GeneralPowers","text":"GeneralPowers\n\nGeneral potential with customizable powers.\n\nFields\n\nconstants::Vector{Float64} : potential constants\npowers::Vector{Int}        : powers for radius\n\n\n\n\n\n","category":"type"},{"location":"use/#Usage-1","page":"Usage","title":"Usage","text":"","category":"section"},{"location":"use/#","page":"Usage","title":"Usage","text":"To calculate potential energy surface refer to PotentialCalculation.Ones you have potential energy calculated you can open it for fitting by using","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"using PotentialFitting, PotentialCalculation\n\n# There is an example potential in test/data directory\nusing PotentialDB\nr = defaultregistry()\ndata=loadpotential(r,\"4\")","category":"page"},{"location":"use/#Setting-up-Molecules-1","page":"Usage","title":"Setting up Molecules","text":"","category":"section"},{"location":"use/#","page":"Usage","title":"Usage","text":"Next part in defining topology for the potential. This is started by creating two molecules. The information is in the loaded file.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"m1=MoleculeIdenticalInformation{AtomOnlySymbol}(data[\"cluster1\"].atoms)\nm2=MoleculeIdenticalInformation{AtomOnlySymbol}(data[\"cluster2\"].atoms)","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"If neede atoms can be flagged as identical.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"# Atoms 2 and 3 are identical\nmakeidentical!(m1, (2,3))","category":"page"},{"location":"use/#Potential-Topology-1","page":"Usage","title":"Potential Topology","text":"","category":"section"},{"location":"use/#","page":"Usage","title":"Usage","text":"Next we need to define topology for the potential.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"mpp = MoleculePairPotential(m1,m2, LennardJones())","category":"page"},{"location":"use/#Finetuning-Potential-1","page":"Usage","title":"Finetuning Potential","text":"","category":"section"},{"location":"use/#","page":"Usage","title":"Usage","text":"Alternatively potential can be tuned complitely by adding potentials one by one.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"# Array where topology is saved\ntopo=[]\n\n#We can push potential to to this array one at the time\npush!(topo,\n      # Molecule 1 has 5 atoms so index 6 is molecule 2, or argon now\n      PairPotentialTopology(LennardJones(), 1,6)\n     )\nnothing # hide","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"If needed we can specify which atoms should be treated as identical, by adding information for it  in the topology.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"# Atoms 2 and 3 of molecule 1 have same potential to to atom 1 of molecule 2\npush!(topo,\n      PairPotentialTopology(LennardJones(), [(2,6), (3,6)])\n     )\nnothing # hide","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"If default form of potential is not enough it can be tuned, by giving it as an input.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"push!(topo,\n      PairPotentialTopology(GeneralPowers(-6,-12), 4,6)\n     )\npush!(topo,\n     PairPotentialTopology(GeneralPowers(-6,-8, -10, -12), 5,6)\n    )\nnothing # hide","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"Here we used general polynomial potential GeneralPowers to make customized polynomic potential.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"We can now create potential.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"mpp1=MoleculePairPotential(m1,m2)\nmpp1.topology = topo\n\nshow(mpp1)","category":"page"},{"location":"use/#Preparing-Data-for-Fitting-1","page":"Usage","title":"Preparing Data for Fitting","text":"","category":"section"},{"location":"use/#","page":"Usage","title":"Usage","text":"To do fitting itself we need to prepare fit data.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"fdata = FitData(mpp, data[\"Points\"], data[\"Energy\"])\nnothing # hide","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"At this point we can add weights to data.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"# If energy is more than 1500 cm⁻¹ weigth is zero\nsetweight_e_more!(fdata, 0, 1500)\n\n# If energy is less than 80 cm⁻¹ weigth is 4\nsetweight_e_less!(fdata,4,80)\nnothing # hide","category":"page"},{"location":"use/#Fitting-Potential-1","page":"Usage","title":"Fitting Potential","text":"","category":"section"},{"location":"use/#","page":"Usage","title":"Usage","text":"We also need to create fitting model. At the current moment only linear models can be used. Here we take normal linear regression, but any linear model suported by ScikitLearn can be used.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"using ScikitLearn\n@sk_import linear_model: LinearRegression\n\nmodel = LinearRegression()\nnothing  # hide","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"To do fitting itself.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"fit_potential!(model, mpp, fdata)","category":"page"},{"location":"use/#Inspecting-Fitted-Potential-1","page":"Usage","title":"Inspecting Fitted Potential","text":"","category":"section"},{"location":"use/#","page":"Usage","title":"Usage","text":"You can inspect the fit by calculating RMSD.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"# Unit is hartree\nrmsd(data[\"Points\"], data[\"Energy\"], mpp)","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"Alternatively you can visualize the fit with various methods.","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"plot_compare(data[\"Points\"][:,1], data[\"Energy\"][:,1], mpp,\n             leg=true, size=(600,300))","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"For more visualizations take a look for","category":"page"},{"location":"use/#","page":"Usage","title":"Usage","text":"plot_compare\nscan_compare\nscan_vizualize\nvisualize_points","category":"page"}]
}
