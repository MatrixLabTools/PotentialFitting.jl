<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example Use Case · PotentialFitting.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PotentialFitting.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../install/">Install</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../use/">Fitting Potential</a></li><li class="is-active"><a class="tocitem" href>Example Use Case</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Fitting-Potential-1"><span>Fitting Potential</span></a></li><li class="toplevel"><a class="tocitem" href="#Preparing-CP2K-input-files-1"><span>Preparing CP2K input files</span></a></li><li><a class="tocitem" href="#Geometry-inputs-1"><span>Geometry inputs</span></a></li><li><a class="tocitem" href="#CP2K-input-file-1"><span>CP2K input file</span></a></li><li class="toplevel"><a class="tocitem" href="#Molecular-dynamics-1"><span>Molecular dynamics</span></a></li><li><a class="tocitem" href="#IR-spectrum-calculation-1"><span>IR spectrum calculation</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Example Use Case</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example Use Case</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MatrixLabTools/PotentialFitting.jl/blob/master/docs/src/exampleusecase.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Overview-of-example-use-1"><a class="docs-heading-anchor" href="#Overview-of-example-use-1">Overview of example use</a><a class="docs-heading-anchor-permalink" href="#Overview-of-example-use-1" title="Permalink"></a></h1><p>This is an example workflow for doing the whole calculation, except calculating potential itself that has been explained else where.</p><p>Molecular dynamics itself consist of 4 phases:</p><ul><li>Equilibration of initial geometry in gas phase</li><li>Condensing gas to solid.</li><li>Equilibration to DFT</li><li>Spectrum calculation</li></ul><h1 id="Fitting-Potential-1"><a class="docs-heading-anchor" href="#Fitting-Potential-1">Fitting Potential</a><a class="docs-heading-anchor-permalink" href="#Fitting-Potential-1" title="Permalink"></a></h1><p>First we need to fit a potential. In this example we fit a potential for trans-formic acid and argon. <a href="https://github.com/MatrixLabTools/PotentialDB.jl">PotentialDB</a> has pre calculated data than we can use for fitting the potential.</p><pre><code class="language-julia">using PotentialDB
r = defaultregistry()
data = loadpotential(r, &quot;4&quot;)</code></pre><pre><code class="language-none">Dict{String,Any} with 6 entries:
  &quot;Method&quot;   =&gt; &quot;CCSD(T)-F12/RI&quot;
  &quot;cluster2&quot; =&gt; Cluster{AtomOnlySymbol} of 1 atoms
  &quot;Energy&quot;   =&gt; [0.0172099 0.0232891 … 0.0210108 0.0160872; 0.0104979 0.0147825…
  &quot;Points&quot;   =&gt; Cluster{AtomOnlySymbol}[Cluster{AtomOnlySymbol} of 6 atoms Clus…
  &quot;cluster1&quot; =&gt; Cluster{AtomOnlySymbol} of 5 atoms
  &quot;Basis&quot;    =&gt; &quot;cc-pVDZ-F12 cc-pVDZ-F12-CABS cc-pVTZ/C TIGHTSCF&quot;</code></pre><p>The fitting procedure is the same as explained in <a href="../use/#Usage-1">Usage</a> section.</p><p>First we create a potential for fitting.</p><pre><code class="language-julia">using PotentialFitting, PotentialCalculation

m1=MoleculeIdenticalInformation{AtomOnlySymbol}(data[&quot;cluster1&quot;].atoms)
m2=MoleculeIdenticalInformation{AtomOnlySymbol}(data[&quot;cluster2&quot;].atoms)

mpp = MoleculePairPotential(m1,m2, GeneralPowers(-6,-8,-10,-12,-7,-9,-11))</code></pre><pre><code class="language-none">Molecule Pair Potential
Molecule 1 has 5 atoms (5 unique) 
Molecule 2 has 1 atoms (1 unique) 

Potential topology:

r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  1C :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  2O :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  3O :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  4H :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 0.0  0.0  0.0  0.0  0.0  0.0  0.0   :  5H :  6Ar
</code></pre><p>Then we prepare fitting data and apply some constrains. The reason why we applying constrains is that our potential is under fitting and as a result depends heavily on the constrains. You can verify this, by taking constrains off and comparing to constrained potential, or by changing the constrains considerably.</p><pre><code class="language-julia">fdata = FitData(mpp, data[&quot;Points&quot;], data[&quot;Energy&quot;])

setweight_e_more!(fdata, 0.1, 1000)
setweight_e_more!(fdata, 0.01, 5000)
setweight_e_less!(fdata, 2, -50)
setweight_e_less!(fdata, 4, -75)
setweight_e_less!(fdata, 16, -100);</code></pre><p>Then we prepare fitting tools for fitting. Linear regression is most likely good enough. But you can also try support vector machines or ridge regression etc.</p><pre><code class="language-julia">using ScikitLearn
@sk_import linear_model: LinearRegression

model = LinearRegression(fit_intercept=false)</code></pre><pre><code class="language-none">PyObject LinearRegression(copy_X=True, fit_intercept=False, n_jobs=1, normalize=False)</code></pre><p>Fitting potential.</p><pre><code class="language-julia">fit_potential!(model, mpp, fdata)</code></pre><pre><code class="language-none">Molecule Pair Potential
Molecule 1 has 5 atoms (5 unique) 
Molecule 2 has 1 atoms (1 unique) 

Potential topology:

r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** -22540.021826685817  -5.243549549254128e6  -3.2406584939854663e7  1.5153599200877088e8  551050.9158835679  2.2664750821113523e7  -5.313204935446245e7   :  1C :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 13739.083816309227  5.471838960588985e6  1.6957305511660287e8  3.7516844784328675e8  -416048.4665519652  -3.998370710003716e7  -3.89843295245451e8   :  2O :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 9793.326627787901  3.1394019939679718e6  7.627842500369161e7  1.3069576652652234e8  -268179.88211563753  -2.0305101910751928e7  -1.5502947628932872e8   :  3O :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** -2432.161794484593  -633286.4449792223  -1.0427110576785028e7  -1.0703348139907856e7  60921.18783964199  3.4584354828949333e6  1.64817021283349e7   :  4H :  6Ar
r^-6  r^-8  r^-10  r^-12  r^-7  r^-9  r^-11   *** 4525.254251613282  858980.445925096  7.2762912901483355e6  -3.206484077195283e6  -99340.84360449202  -3.6312235994796865e6  -4.349257678219102e6   :  5H :  6Ar
</code></pre><p>Check root mean square deviation for potential.</p><pre><code class="language-julia">rmsd(data[&quot;Points&quot;], data[&quot;Energy&quot;], mpp, emax=-10)</code></pre><pre><code class="language-none">8.367955631368698</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>We are under fitting our potential, so we can safely compare the potential to the data we used for the fitting. But it would be a good idea to confirm this, by comparing to some data that was not used for fitting.</p></div></div><p>To inspect the potential we can use use <code>plot_compare</code> which will calculate potential for given points. Here we visualize one line from potential.</p><pre><code class="language-julia">plot_compare(data[&quot;Points&quot;][:,30], data[&quot;Energy&quot;][:,30], mpp, leg=true)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800" height="400" viewBox="0 0 3200 1600">
<defs>
  <clipPath id="clip9500">
    <rect x="0" y="0" width="3200" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip9500)" d="
M0 1600 L3200 1600 L3200 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip9501">
    <rect x="640" y="0" width="2241" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip9500)" d="
M102.74 1505.26 L3152.76 1505.26 L3152.76 47.2441 L102.74 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip9502">
    <rect x="102" y="47" width="3051" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip9502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  409.349,1505.26 409.349,47.2441 
  "/>
<polyline clip-path="url(#clip9502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  977.623,1505.26 977.623,47.2441 
  "/>
<polyline clip-path="url(#clip9502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1545.9,1505.26 1545.9,47.2441 
  "/>
<polyline clip-path="url(#clip9502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2114.17,1505.26 2114.17,47.2441 
  "/>
<polyline clip-path="url(#clip9502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2682.44,1505.26 2682.44,47.2441 
  "/>
<polyline clip-path="url(#clip9502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  102.74,1191.51 3152.76,1191.51 
  "/>
<polyline clip-path="url(#clip9502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  102.74,848.902 3152.76,848.902 
  "/>
<polyline clip-path="url(#clip9502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  102.74,506.292 3152.76,506.292 
  "/>
<polyline clip-path="url(#clip9502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  102.74,163.682 3152.76,163.682 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,1505.26 3152.76,1505.26 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,1505.26 102.74,47.2441 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  409.349,1505.26 409.349,1487.76 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  977.623,1505.26 977.623,1487.76 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1545.9,1505.26 1545.9,1487.76 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2114.17,1505.26 2114.17,1487.76 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2682.44,1505.26 2682.44,1487.76 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,1191.51 139.34,1191.51 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,848.902 139.34,848.902 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,506.292 139.34,506.292 
  "/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  102.74,163.682 139.34,163.682 
  "/>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;" transform="rotate(0, 409.349, 1624.46)" x="409.349" y="1624.46">3</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;" transform="rotate(0, 977.623, 1624.46)" x="977.623" y="1624.46">4</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;" transform="rotate(0, 1545.9, 1624.46)" x="1545.9" y="1624.46">5</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;" transform="rotate(0, 2114.17, 1624.46)" x="2114.17" y="1624.46">6</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;" transform="rotate(0, 2682.44, 1624.46)" x="2682.44" y="1624.46">7</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:end;" transform="rotate(0, 70.7402, 1234.51)" x="70.7402" y="1234.51">-100</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:end;" transform="rotate(0, 70.7402, 891.902)" x="70.7402" y="891.902">-50</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:end;" transform="rotate(0, 70.7402, 549.292)" x="70.7402" y="549.292">0</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:end;" transform="rotate(0, 70.7402, 206.682)" x="70.7402" y="206.682">50</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;" transform="rotate(0, 1627.75, 1722.57)" x="1627.75" y="1722.57">Min Distance  [Å]</text>
</g>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;" transform="rotate(-90, -243.815, 776.252)" x="-243.815" y="776.252">Energy   [cm^-1]</text>
</g>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="189.061" cy="566.121" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="189.061" cy="566.121" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="254.686" cy="1118.08" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="254.686" cy="1118.08" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="320.475" cy="1377.94" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="320.475" cy="1377.94" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="386.409" cy="1464" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="386.409" cy="1464" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="452.473" cy="1451.4" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="452.473" cy="1451.4" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="518.652" cy="1386.91" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="518.652" cy="1386.91" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="584.934" cy="1298.86" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="584.934" cy="1298.86" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="651.308" cy="1203.8" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="651.308" cy="1203.8" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="717.765" cy="1111.01" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="717.765" cy="1111.01" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="784.298" cy="1025.26" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="784.298" cy="1025.26" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="850.899" cy="948.703" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="850.899" cy="948.703" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="917.562" cy="881.912" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="917.562" cy="881.912" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="984.281" cy="824.615" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="984.281" cy="824.615" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1051.05" cy="776.059" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1051.05" cy="776.059" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1117.87" cy="735.254" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1117.87" cy="735.254" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1184.73" cy="701.156" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1184.73" cy="701.156" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1251.64" cy="672.735" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1251.64" cy="672.735" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1318.58" cy="649.055" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1318.58" cy="649.055" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1385.55" cy="629.295" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1385.55" cy="629.295" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1452.56" cy="612.755" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1452.56" cy="612.755" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1519.59" cy="598.855" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1519.59" cy="598.855" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1586.66" cy="587.12" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1586.66" cy="587.12" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1653.74" cy="577.165" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1653.74" cy="577.165" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1720.86" cy="568.681" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1720.86" cy="568.681" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1787.99" cy="561.415" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1787.99" cy="561.415" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1855.15" cy="555.154" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1855.15" cy="555.154" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1922.32" cy="549.748" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1922.32" cy="549.748" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="1989.52" cy="545.049" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="1989.52" cy="545.049" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2056.73" cy="540.953" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2056.73" cy="540.953" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2123.96" cy="537.37" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2123.96" cy="537.37" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2191.2" cy="534.221" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2191.2" cy="534.221" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2258.46" cy="531.447" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2258.46" cy="531.447" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2325.73" cy="528.993" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2325.73" cy="528.993" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2393.01" cy="526.818" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2393.01" cy="526.818" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2460.31" cy="524.886" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2460.31" cy="524.886" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2527.62" cy="523.165" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2527.62" cy="523.165" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2594.94" cy="521.626" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2594.94" cy="521.626" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2662.27" cy="520.256" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2662.27" cy="520.256" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2729.61" cy="519.022" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2729.61" cy="519.022" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2796.95" cy="517.916" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2796.95" cy="517.916" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2864.31" cy="516.918" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2864.31" cy="516.918" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2931.68" cy="516.019" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2931.68" cy="516.019" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2999.05" cy="515.216" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2999.05" cy="515.216" r="14"/>
<circle clip-path="url(#clip9502)" style="fill:#000000; stroke:none; fill-opacity:1" cx="3066.43" cy="514.481" r="18"/>
<circle clip-path="url(#clip9502)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="3066.43" cy="514.481" r="14"/>
<polyline clip-path="url(#clip9502)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  189.061,88.5087 254.686,783.982 320.475,1157.1 386.409,1329.82 452.473,1380.51 518.652,1359.64 584.934,1299.55 651.308,1220.68 717.765,1135.65 784.298,1051.98 
  850.899,973.818 917.562,903.231 984.281,840.947 1051.05,786.909 1117.87,740.614 1184.73,701.335 1251.64,668.261 1318.58,640.578 1385.55,617.52 1452.56,598.388 
  1519.59,582.562 1586.66,569.503 1653.74,558.75 1720.86,549.907 1787.99,542.644 1855.15,536.682 1922.32,531.79 1989.52,527.776 2056.73,524.481 2123.96,521.775 
  2191.2,519.549 2258.46,517.715 2325.73,516.2 2393.01,514.947 2460.31,513.906 2527.62,513.038 2594.94,512.31 2662.27,511.698 2729.61,511.179 2796.95,510.737 
  2864.31,510.356 2931.68,510.027 2999.05,509.74 3066.43,509.488 
  "/>
<path clip-path="url(#clip9500)" d="
M2509.37 360.204 L3056.76 360.204 L3056.76 178.764 L2509.37 178.764  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip9500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2509.37,360.204 3056.76,360.204 3056.76,178.764 2509.37,178.764 2509.37,360.204 
  "/>
<circle clip-path="url(#clip9500)" style="fill:#000000; stroke:none; fill-opacity:1" cx="2653.37" cy="239.244" r="25"/>
<circle clip-path="url(#clip9500)" style="fill:#009af9; stroke:none; fill-opacity:1" cx="2653.37" cy="239.244" r="21"/>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2765.37, 256.744)" x="2765.37" y="256.744">Calculated</text>
</g>
<polyline clip-path="url(#clip9500)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  2541.37,299.724 2733.37,299.724 
  "/>
<g clip-path="url(#clip9500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2765.37, 317.224)" x="2765.37" y="317.224">Fit</text>
</g>
</svg>
<p><code>scan_compare</code>-command is also available and usually much faster to visualize the fit.</p><pre><code class="language-julia">scan_compare(data[&quot;Points&quot;], data[&quot;Energy&quot;], mpp, leg=true)</code></pre><div
    class="webio-mountpoint"
    data-webio-mountpoint="810410298391846684"
>
    <script>
    if (window.require && require.defined && require.defined("nbextensions/webio-jupyter-notebook")) {
        console.log("Jupyter WebIO extension detected, not mounting.");
    } else if (window.WebIO) {
        WebIO.mount(
            document.querySelector('[data-webio-mountpoint="810410298391846684"]'),
            {"props":{},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[{"props":{"className":"field interact-widget"},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[{"props":{},"nodeType":"Scope","type":"node","instanceArgs":{"imports":{"data":[{"name":"knockout","type":"js","url":"\/assetserver\/d2de49ec941a4af8c276f6e895634db3d13c2837-knockout.js"},{"name":"knockout_punches","type":"js","url":"\/assetserver\/3e16b6ce864590a072467dd95579a8a571f19dc1-knockout_punches.js"},{"name":null,"type":"js","url":"\/assetserver\/d8fbd46e9da3023a7d917d5b22195424b65cb7bc-all.js"},{"name":null,"type":"css","url":"\/assetserver\/10990203ed7c5445860466b018c7617a7f170c72-style.css"},{"name":null,"type":"css","url":"\/assetserver\/9d9d25d10c1067f3ced893d3662882548814a4af-bulma.min.css"}],"type":"async_block"},"id":"9476083114157896008","handlers":{"options_js":["(function (val){return (val!=this.model[\"options_js\"]()) ? (this.valueFromJulia[\"options_js\"]=true, this.model[\"options_js\"](val)) : undefined})"],"index":["(function (val){return (val!=this.model[\"index\"]()) ? (this.valueFromJulia[\"index\"]=true, this.model[\"index\"](val)) : undefined})"]},"systemjs_options":null,"mount_callbacks":["function () {\n    var handler = (function (ko, koPunches) {\n    ko.punches.enableAll();\n    ko.bindingHandlers.numericValue = {\n        init: function(element, valueAccessor, allBindings, data, context) {\n            var stringified = ko.observable(ko.unwrap(valueAccessor()));\n            stringified.subscribe(function(value) {\n                var val = parseFloat(value);\n                if (!isNaN(val)) {\n                    valueAccessor()(val);\n                }\n            });\n            valueAccessor().subscribe(function(value) {\n                var str = JSON.stringify(value);\n                if ((str == \"0\") && ([\"-0\", \"-0.\"].indexOf(stringified()) >= 0))\n                     return;\n                 if ([\"null\", \"\"].indexOf(str) >= 0)\n                     return;\n                stringified(str);\n            });\n            ko.applyBindingsToNode(\n                element,\n                {\n                    value: stringified,\n                    valueUpdate: allBindings.get('valueUpdate'),\n                },\n                context,\n            );\n        }\n    };\n    var json_data = {\"options_js\":WebIO.getval({\"name\":\"options_js\",\"scope\":\"9476083114157896008\",\"id\":\"ob_05\",\"type\":\"observable\"}),\"index\":WebIO.getval({\"name\":\"index\",\"scope\":\"9476083114157896008\",\"id\":\"ob_04\",\"type\":\"observable\"})};\n    var self = this;\n    function AppViewModel() {\n        for (var key in json_data) {\n            var el = json_data[key];\n            this[key] = Array.isArray(el) ? ko.observableArray(el) : ko.observable(el);\n        }\n        [this[\"disablePlaceholder\"]=function(option, item) {\n    ko.applyBindingsToNode(option, {disable: item.val == 0}, item);\n}\n]\n        \n        [this[\"options_js\"].subscribe((function (val){!(this.valueFromJulia[\"options_js\"]) ? (WebIO.setval({\"name\":\"options_js\",\"scope\":\"9476083114157896008\",\"id\":\"ob_05\",\"type\":\"observable\"},val)) : undefined; return this.valueFromJulia[\"options_js\"]=false}),self),this[\"index\"].subscribe((function (val){!(this.valueFromJulia[\"index\"]) ? (WebIO.setval({\"name\":\"index\",\"scope\":\"9476083114157896008\",\"id\":\"ob_04\",\"type\":\"observable\"},val)) : undefined; return this.valueFromJulia[\"index\"]=false}),self)]\n        \n    }\n    self.model = new AppViewModel();\n    self.valueFromJulia = {};\n    for (var key in json_data) {\n        self.valueFromJulia[key] = false;\n    }\n    ko.applyBindings(self.model, self.dom);\n}\n);\n    (WebIO.importBlock({\"data\":[{\"name\":\"knockout\",\"type\":\"js\",\"url\":\"\/assetserver\/d2de49ec941a4af8c276f6e895634db3d13c2837-knockout.js\"},{\"name\":\"knockout_punches\",\"type\":\"js\",\"url\":\"\/assetserver\/3e16b6ce864590a072467dd95579a8a571f19dc1-knockout_punches.js\"}],\"type\":\"async_block\"})).then((imports) => handler.apply(this, imports));\n}\n"],"observables":{"options_js":{"sync":false,"id":"ob_05","value":[{"key":"cm^-1","val":1,"id":"idSpd9LJjc"},{"key":"kcal\/mol","val":2,"id":"idWvjCVw6r"},{"key":"kJ\/mol","val":3,"id":"idDz9Q4qaP"},{"key":"eV","val":4,"id":"idIx6ScBEk"},{"key":"K","val":5,"id":"id5vzQElgg"},{"key":"hartree","val":6,"id":"idOpottHqA"}]},"index":{"sync":true,"id":"ob_04","value":1}}},"children":[{"props":{"style":{"display":"flex","flex-direction":"column"}},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":["Energy unit",{"props":{"className":"select "},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[{"props":{"attributes":{"data-bind":"options : options_js, value : index, optionsText: 'key', optionsValue: 'val', valueAllowUnset: true, optionsAfterRender: disablePlaceholder"}},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"select"},"children":[]}]}]}]}]},{"props":{"className":"field interact-widget"},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[{"props":{},"nodeType":"Scope","type":"node","instanceArgs":{"imports":{"data":[{"name":"knockout","type":"js","url":"\/assetserver\/d2de49ec941a4af8c276f6e895634db3d13c2837-knockout.js"},{"name":"knockout_punches","type":"js","url":"\/assetserver\/3e16b6ce864590a072467dd95579a8a571f19dc1-knockout_punches.js"},{"name":null,"type":"js","url":"\/assetserver\/d8fbd46e9da3023a7d917d5b22195424b65cb7bc-all.js"},{"name":null,"type":"css","url":"\/assetserver\/10990203ed7c5445860466b018c7617a7f170c72-style.css"},{"name":null,"type":"css","url":"\/assetserver\/9d9d25d10c1067f3ced893d3662882548814a4af-bulma.min.css"}],"type":"async_block"},"id":"5509167109699681673","handlers":{"changes":["(function (val){return (val!=this.model[\"changes\"]()) ? (this.valueFromJulia[\"changes\"]=true, this.model[\"changes\"](val)) : undefined})"],"index":["(function (val){return (val!=this.model[\"index\"]()) ? (this.valueFromJulia[\"index\"]=true, this.model[\"index\"](val)) : undefined})"]},"systemjs_options":null,"mount_callbacks":["function () {\n    var handler = (function (ko, koPunches) {\n    ko.punches.enableAll();\n    ko.bindingHandlers.numericValue = {\n        init: function(element, valueAccessor, allBindings, data, context) {\n            var stringified = ko.observable(ko.unwrap(valueAccessor()));\n            stringified.subscribe(function(value) {\n                var val = parseFloat(value);\n                if (!isNaN(val)) {\n                    valueAccessor()(val);\n                }\n            });\n            valueAccessor().subscribe(function(value) {\n                var str = JSON.stringify(value);\n                if ((str == \"0\") && ([\"-0\", \"-0.\"].indexOf(stringified()) >= 0))\n                     return;\n                 if ([\"null\", \"\"].indexOf(str) >= 0)\n                     return;\n                stringified(str);\n            });\n            ko.applyBindingsToNode(\n                element,\n                {\n                    value: stringified,\n                    valueUpdate: allBindings.get('valueUpdate'),\n                },\n                context,\n            );\n        }\n    };\n    var json_data = {\"formatted_vals\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\"],\"changes\":WebIO.getval({\"name\":\"changes\",\"scope\":\"5509167109699681673\",\"id\":\"ob_07\",\"type\":\"observable\"}),\"index\":WebIO.getval({\"name\":\"index\",\"scope\":\"5509167109699681673\",\"id\":\"ob_06\",\"type\":\"observable\"})};\n    var self = this;\n    function AppViewModel() {\n        for (var key in json_data) {\n            var el = json_data[key];\n            this[key] = Array.isArray(el) ? ko.observableArray(el) : ko.observable(el);\n        }\n        \n        [this[\"formatted_val\"]=ko.computed(    function(){\n        return this.formatted_vals()[parseInt(this.index())-(1)];\n    }\n,this)]\n        [this[\"changes\"].subscribe((function (val){!(this.valueFromJulia[\"changes\"]) ? (WebIO.setval({\"name\":\"changes\",\"scope\":\"5509167109699681673\",\"id\":\"ob_07\",\"type\":\"observable\"},val)) : undefined; return this.valueFromJulia[\"changes\"]=false}),self),this[\"index\"].subscribe((function (val){!(this.valueFromJulia[\"index\"]) ? (WebIO.setval({\"name\":\"index\",\"scope\":\"5509167109699681673\",\"id\":\"ob_06\",\"type\":\"observable\"},val)) : undefined; return this.valueFromJulia[\"index\"]=false}),self)]\n        \n    }\n    self.model = new AppViewModel();\n    self.valueFromJulia = {};\n    for (var key in json_data) {\n        self.valueFromJulia[key] = false;\n    }\n    ko.applyBindings(self.model, self.dom);\n}\n);\n    (WebIO.importBlock({\"data\":[{\"name\":\"knockout\",\"type\":\"js\",\"url\":\"\/assetserver\/d2de49ec941a4af8c276f6e895634db3d13c2837-knockout.js\"},{\"name\":\"knockout_punches\",\"type\":\"js\",\"url\":\"\/assetserver\/3e16b6ce864590a072467dd95579a8a571f19dc1-knockout_punches.js\"}],\"type\":\"async_block\"})).then((imports) => handler.apply(this, imports));\n}\n"],"observables":{"changes":{"sync":false,"id":"ob_07","value":0},"index":{"sync":true,"id":"ob_06","value":48}}},"children":[{"props":{"className":"interact-flex-row interact-widget"},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[{"props":{"className":"interact-flex-row-left"},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[{"props":{"className":"interact ","style":{"padding":"5px 10px 0px 10px"}},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"label"},"children":["Collumn"]}]},{"props":{"className":"interact-flex-row-center"},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[{"props":{"max":96,"min":1,"attributes":{"type":"range","data-bind":"numericValue: index, valueUpdate: 'input', event: {change: function (){this.changes(this.changes()+1)}}","orient":"horizontal"},"step":1,"className":"slider slider is-fullwidth","style":{}},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"input"},"children":[]}]},{"props":{"className":"interact-flex-row-right"},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[{"props":{"attributes":{"data-bind":"text: formatted_val"}},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"p"},"children":[]}]}]}]}]},{"props":{},"nodeType":"Scope","type":"node","instanceArgs":{"imports":{"data":[],"type":"async_block"},"id":"10458175550379119125","handlers":{},"systemjs_options":null,"mount_callbacks":[],"observables":{"obs-node":{"sync":false,"id":"ob_11","value":{"props":{"className":"interact-flex-row interact-widget"},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[{"props":{"setInnerHtml":"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" xmlns:xlink=\"http:\/\/www.w3.org\/1999\/xlink\" width=\"800\" height=\"400\" viewBox=\"0 0 3200 1600\">\n<defs>\n  <clipPath id=\"clip0100\">\n    <rect x=\"0\" y=\"0\" width=\"3200\" height=\"1600\"\/>\n  <\/clipPath>\n<\/defs>\n<path clip-path=\"url(#clip0100)\" d=\"\nM0 1600 L3200 1600 L3200 0 L0 0  Z\n  \" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"\/>\n<defs>\n  <clipPath id=\"clip0101\">\n    <rect x=\"640\" y=\"0\" width=\"2241\" height=\"1600\"\/>\n  <\/clipPath>\n<\/defs>\n<path clip-path=\"url(#clip0100)\" d=\"\nM110.74 1505.26 L3152.76 1505.26 L3152.76 47.2441 L110.74 47.2441  Z\n  \" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"\/>\n<defs>\n  <clipPath id=\"clip0102\">\n    <rect x=\"110\" y=\"47\" width=\"3043\" height=\"1459\"\/>\n  <\/clipPath>\n<\/defs>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"\n  465.822,1505.26 465.822,47.2441 \n  \"\/>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"\n  1030.01,1505.26 1030.01,47.2441 \n  \"\/>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"\n  1594.21,1505.26 1594.21,47.2441 \n  \"\/>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"\n  2158.4,1505.26 2158.4,47.2441 \n  \"\/>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"\n  2722.59,1505.26 2722.59,47.2441 \n  \"\/>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"\n  110.74,1469.78 3152.76,1469.78 \n  \"\/>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"\n  110.74,1007.34 3152.76,1007.34 \n  \"\/>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"\n  110.74,544.903 3152.76,544.903 \n  \"\/>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"\n  110.74,82.4613 3152.76,82.4613 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  110.74,1505.26 3152.76,1505.26 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  110.74,1505.26 110.74,47.2441 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  465.822,1505.26 465.822,1487.76 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  1030.01,1505.26 1030.01,1487.76 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  1594.21,1505.26 1594.21,1487.76 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  2158.4,1505.26 2158.4,1487.76 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  2722.59,1505.26 2722.59,1487.76 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  110.74,1469.78 147.244,1469.78 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  110.74,1007.34 147.244,1007.34 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  110.74,544.903 147.244,544.903 \n  \"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  110.74,82.4613 147.244,82.4613 \n  \"\/>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;\" transform=\"rotate(0, 465.822, 1624.46)\" x=\"465.822\" y=\"1624.46\">3<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;\" transform=\"rotate(0, 1030.01, 1624.46)\" x=\"1030.01\" y=\"1624.46\">4<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;\" transform=\"rotate(0, 1594.21, 1624.46)\" x=\"1594.21\" y=\"1624.46\">5<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;\" transform=\"rotate(0, 2158.4, 1624.46)\" x=\"2158.4\" y=\"1624.46\">6<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:middle;\" transform=\"rotate(0, 2722.59, 1624.46)\" x=\"2722.59\" y=\"1624.46\">7<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:end;\" transform=\"rotate(0, 78.7402, 1512.78)\" x=\"78.7402\" y=\"1512.78\">-150<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:end;\" transform=\"rotate(0, 78.7402, 1050.34)\" x=\"78.7402\" y=\"1050.34\">-100<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:end;\" transform=\"rotate(0, 78.7402, 587.903)\" x=\"78.7402\" y=\"587.903\">-50<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:118px; text-anchor:end;\" transform=\"rotate(0, 78.7402, 125.461)\" x=\"78.7402\" y=\"125.461\">0<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1631.75, 1722.57)\" x=\"1631.75\" y=\"1722.57\">Min Distance  [Å]<\/text>\n<\/g>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(-90, -235.815, 776.252)\" x=\"-235.815\" y=\"776.252\">Energy   [cm^-1]<\/text>\n<\/g>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"196.835\" cy=\"107.014\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"196.835\" cy=\"107.014\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"262.823\" cy=\"897.705\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"262.823\" cy=\"897.705\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"328.909\" cy=\"1267.75\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"328.909\" cy=\"1267.75\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"395.082\" cy=\"1390.32\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"395.082\" cy=\"1390.32\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"461.331\" cy=\"1373.81\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"461.331\" cy=\"1373.81\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"527.647\" cy=\"1284.78\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"527.647\" cy=\"1284.78\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"594.024\" cy=\"1163.14\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"594.024\" cy=\"1163.14\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"660.455\" cy=\"1032.11\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"660.455\" cy=\"1032.11\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"726.935\" cy=\"904.532\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"726.935\" cy=\"904.532\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"793.457\" cy=\"786.993\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"793.457\" cy=\"786.993\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"860.02\" cy=\"682.317\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"860.02\" cy=\"682.317\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"926.618\" cy=\"592.154\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"926.618\" cy=\"592.154\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"993.249\" cy=\"513.087\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"993.249\" cy=\"513.087\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1059.91\" cy=\"446.894\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1059.91\" cy=\"446.894\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1126.6\" cy=\"391.24\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1126.6\" cy=\"391.24\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1193.31\" cy=\"344.7\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1193.31\" cy=\"344.7\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1260.04\" cy=\"305.908\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1260.04\" cy=\"305.908\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1326.8\" cy=\"273.61\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1326.8\" cy=\"273.61\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1393.58\" cy=\"246.934\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1393.58\" cy=\"246.934\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1460.37\" cy=\"224.486\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1460.37\" cy=\"224.486\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1527.18\" cy=\"205.68\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1527.18\" cy=\"205.68\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1594.01\" cy=\"189.859\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1594.01\" cy=\"189.859\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1660.85\" cy=\"176.481\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1660.85\" cy=\"176.481\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1727.71\" cy=\"165.111\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1727.71\" cy=\"165.111\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1794.57\" cy=\"155.397\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1794.57\" cy=\"155.397\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1861.45\" cy=\"147.05\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1861.45\" cy=\"147.05\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1928.34\" cy=\"139.853\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1928.34\" cy=\"139.853\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"1995.24\" cy=\"133.61\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"1995.24\" cy=\"133.61\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2062.15\" cy=\"128.181\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2062.15\" cy=\"128.181\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2129.07\" cy=\"123.437\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2129.07\" cy=\"123.437\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2196\" cy=\"119.282\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2196\" cy=\"119.282\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2262.94\" cy=\"115.625\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2262.94\" cy=\"115.625\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2329.88\" cy=\"112.139\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2329.88\" cy=\"112.139\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2396.83\" cy=\"109.285\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2396.83\" cy=\"109.285\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2463.79\" cy=\"106.757\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2463.79\" cy=\"106.757\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2530.75\" cy=\"104.503\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2530.75\" cy=\"104.503\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2597.72\" cy=\"102.496\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2597.72\" cy=\"102.496\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2664.7\" cy=\"100.698\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2664.7\" cy=\"100.698\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2731.68\" cy=\"99.0905\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2731.68\" cy=\"99.0905\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2798.67\" cy=\"97.6483\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2798.67\" cy=\"97.6483\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2865.66\" cy=\"96.3466\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2865.66\" cy=\"96.3466\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2932.65\" cy=\"95.1733\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2932.65\" cy=\"95.1733\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2999.66\" cy=\"94.1179\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2999.66\" cy=\"94.1179\" r=\"14\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"3066.66\" cy=\"93.1607\" r=\"18\"\/>\n<circle clip-path=\"url(#clip0102)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"3066.66\" cy=\"93.1607\" r=\"14\"\/>\n<polyline clip-path=\"url(#clip0102)\" style=\"stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  196.835,537.015 262.823,1167.2 328.909,1420.67 395.082,1464 461.331,1398.12 527.647,1282.17 594.024,1149.46 660.455,1017.73 726.935,895.625 793.457,786.612 \n  860.02,691.388 926.618,609.24 993.249,538.843 1059.91,478.683 1126.6,427.281 1193.31,383.293 1260.04,345.55 1326.8,313.057 1393.58,284.981 1460.37,260.63 \n  1527.18,239.431 1594.01,220.911 1660.85,204.68 1727.71,190.412 1794.57,177.837 1861.45,166.728 1928.34,156.896 1995.24,148.177 2062.15,140.436 2129.07,133.554 \n  2196,127.43 2262.94,121.976 2329.88,117.117 2396.83,112.786 2463.79,108.924 2530.75,105.481 2597.72,102.41 2664.7,99.6731 2731.68,97.2333 2798.67,95.0596 \n  2865.66,93.1239 2932.65,91.4013 2999.66,89.8696 3066.66,88.5087 \n  \"\/>\n<path clip-path=\"url(#clip0100)\" d=\"\nM2509.37 360.204 L3056.76 360.204 L3056.76 178.764 L2509.37 178.764  Z\n  \" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"\/>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  2509.37,360.204 3056.76,360.204 3056.76,178.764 2509.37,178.764 2509.37,360.204 \n  \"\/>\n<circle clip-path=\"url(#clip0100)\" style=\"fill:#000000; stroke:none; fill-opacity:1\" cx=\"2653.37\" cy=\"239.244\" r=\"25\"\/>\n<circle clip-path=\"url(#clip0100)\" style=\"fill:#009af9; stroke:none; fill-opacity:1\" cx=\"2653.37\" cy=\"239.244\" r=\"21\"\/>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;\" transform=\"rotate(0, 2765.37, 256.744)\" x=\"2765.37\" y=\"256.744\">Calculated<\/text>\n<\/g>\n<polyline clip-path=\"url(#clip0100)\" style=\"stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none\" points=\"\n  2541.37,299.724 2733.37,299.724 \n  \"\/>\n<g clip-path=\"url(#clip0100)\">\n<text style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;\" transform=\"rotate(0, 2765.37, 317.224)\" x=\"2765.37\" y=\"317.224\">Fit<\/text>\n<\/g>\n<\/svg>\n"},"nodeType":"DOM","type":"node","instanceArgs":{"namespace":"html","tag":"div"},"children":[]}]}}}},"children":[{"props":{},"nodeType":"ObservableNode","type":"node","instanceArgs":{"id":"ob_11","name":"obs-node"},"children":[]}]}]},
            window,
        );
    } else {
        document
            .querySelector('[data-webio-mountpoint="810410298391846684"]')
            .innerHTML = (
                '<div style="padding: 1em; background-color: #f8d6da; border: 1px solid #f5c6cb">' +
                '<p><strong>WebIO not detected.</strong></p>' +
                '<p>Please read ' +
                '<a href="https://juliagizmos.github.io/WebIO.jl/latest/troubleshooting/not-detected/" target="_blank">the troubleshooting guide</a> ' +
                'for more information on how to resolve this issue.</p>' +
                '<p><a href="https://juliagizmos.github.io/WebIO.jl/latest/troubleshooting/not-detected/" target="_blank">https://juliagizmos.github.io/WebIO.jl/latest/troubleshooting/not-detected/</a></p>' +
                '</div>'
            );
    }
    </script>
</div>
<p>If you found a place in the potential that is not well fitted and want to know where it is, you can visualize it. There are two options</p><ul><li><code>scan_visualize</code> Uses <a href="https://github.com/jgreener64/Bio3DView.jl">Bio3DView</a> and needs IJulia (Jupyter notebook) or <a href="https://github.com/JuliaGizmos/Blink.jl">Blink</a> to work.</li><li><code>visualize_points</code> This calls external program (defaults to VMD) for visualizations. Does not work with IJulia.</li></ul><p>To call them use</p><pre><code class="language-julia">scan_visualize(data[&quot;Points&quot;])</code></pre><pre><code class="language-julia"># Visualize line 32 using vmd
visualize_points(data[&quot;Points&quot;][:,32], command=&quot;vmd&quot;)</code></pre><h1 id="Preparing-CP2K-input-files-1"><a class="docs-heading-anchor" href="#Preparing-CP2K-input-files-1">Preparing CP2K input files</a><a class="docs-heading-anchor-permalink" href="#Preparing-CP2K-input-files-1" title="Permalink"></a></h1><h2 id="Geometry-inputs-1"><a class="docs-heading-anchor" href="#Geometry-inputs-1">Geometry inputs</a><a class="docs-heading-anchor-permalink" href="#Geometry-inputs-1" title="Permalink"></a></h2><p>First grab your favorite and make two file, one for the molecule/cluster you are studying and one for matrix and save them in PDB-format. Here we have a file for formic acid and an other for argon.</p><pre><code class="language-none">COMPND    UNNAMED
AUTHOR    GENERATED BY OPEN BABEL 2.3.2
HETATM    1  C   tfa     1      42.585  42.840  42.933  1.00  0.00           C
HETATM    2  Oh  tfa     1      43.930  42.838  42.829  1.00  0.00           O
HETATM    3  Oo  tfa     1      42.014  43.738  43.531  1.00  0.00           O
HETATM    4  Ho  tfa     1      44.463  43.543  43.222  1.00  0.00           H
HETATM    5  Hc  tfa     1      42.008  42.039  42.484  1.00  0.00           H
CONECT    1    2    3    5                                            
CONECT    2    1    4                                                 
CONECT    3    1                                                      
CONECT    4    2                                                      
CONECT    5    1                                                      
MASTER        0    0    0    0    0    0    0    0    5    0    5    0
END</code></pre><pre><code class="language-none">COMPND    UNNAMED
AUTHOR    GENERATED BY OPEN BABEL 2.3.2
HETATM    6 AR   LIG     2       1.472  80.636  12.825  1.00  0.00           Ar
MASTER        0    0    0    0    0    0    0    0    1    0    1    0
END</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>You need to have different residue names for QM and MM atoms, here &quot;tfa&quot; (trans-formic acid) and &quot;LIG&quot;. This is demanded by CP2K.</p></div></div><p>You also need to put different identifiers to atoms at this point. Here we have:</p><ul><li><code>Oh</code> : hydroxyl group oxygen</li><li><code>Oo</code> : carbonyl group oxygen</li><li><code>Ho</code> : hydroxyl group hydrogen</li><li><code>Hc</code> : hydrogen connected to carbon</li></ul><p>Next we need to decide initial simulation box size, which depends on number of atoms in simulation. If we have 1000 argon atoms then good initial box size is 86 Å. To put the molecule in box we need extra tools. <a href="http://www.gromacs.org">Gromacs</a> in example has that kind of tools.</p><p>To to put the molecule into the box we use <code>gmx editconf</code> command</p><pre><code class="language-none">gmx editconf -f tfa.pdb -box 8.6 8.6 8.6 -o tfa-b86.pdb</code></pre><p>Here we use 86x86x86 Å box, which is ok when using 1000-matrix atoms. But you can adjust this, depending on how many matrix atoms you have.</p><p>Next we need to add argon atoms into the box. For this we use <code>gmx insert-molecules</code> command</p><pre><code class="language-none">gmx insert-molecules -f tfa-b86.pdb -ci ar.pdb -nmol 1000 -o tfa-ar.pdb</code></pre><p>And now we have the final geometry input.</p><h2 id="CP2K-input-file-1"><a class="docs-heading-anchor" href="#CP2K-input-file-1">CP2K input file</a><a class="docs-heading-anchor-permalink" href="#CP2K-input-file-1" title="Permalink"></a></h2><p>The best way to make CP2K input file is to split the file to several parts and using <code>@include</code>-commands to gather them to one file.</p><p>To do this we make</p><ul><li>MM-potential file</li><li>QM-calculation file</li><li>QMMM-boundary file</li><li>CP2K file to gather</li></ul><p>First we make the MM-potential file.</p><pre><code class="language-none">&amp;MM
    &amp;FORCEFIELD
      &amp;CHARGE
         ATOM Ar
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM C
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM Oo
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM Ho
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM Hc
         CHARGE 0.0
      &amp;END CHARGE
      &amp;CHARGE
         ATOM Oh
         CHARGE 0.0
      &amp;END CHARGE

      IGNORE_MISSING_CRITICAL_PARAMS .TRUE.
      &amp;NONBONDED
        # Argon-argon potential from http://www.sklogwiki.org/SklogWiki/index.php/Argon
        &amp;LENNARD-JONES
          ATOMS Ar Ar
          EPSILON [K_e] 125.7
          SIGMA [angstrom] 3.345
          RCUT [angstrom] 9.0
        &amp;END LENNARD-JONES

        # trans Formic acid - argon
        # Just copy the potential terms from potential fit here
        &amp;GENPOT
            atoms Ar C
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES -22540.021633788096  -5.243549409354186e6  -3.2406578590178587e7  1.515360096536201e8  551050.9077903178  2.266474955203762e7  -5.3132065936126545e7
            RCUT [angstrom] 9.0
        &amp;END GENPOT
        &amp;GENPOT
            atoms Ar Oh
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES 13739.083360114846  5.471838619459709e6  1.6957303994470203e8  3.7516840650039065e8  -416048.44688283757  -3.998370403083761e7  -3.898432560739321e8
            RCUT [angstrom] 9.0
        &amp;END GENPOT
        &amp;GENPOT
            atoms Ar Oo
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES 9793.326640804324  3.1394020151115586e6  7.627842607574251e7  1.3069576949556419e8  -268179.8831127547  -2.0305102118835907e7  -1.550294791017888e8
            RCUT [angstrom] 9.0
        &amp;END GENPOT
        &amp;GENPOT
            atoms Ar Ho
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES -2432.1617929808244  -633286.4451121971  -1.042711058845794e7  -1.070334816166878e7  60921.18782589104  3.4584354851854523e6  1.6481702154332923e7
            RCUT [angstrom] 9.0
        &amp;END GENPOT
        &amp;GENPOT
            atoms Ar Hc
            FUNCTION Cvi/(r^6) + Cviii/(r^8) + Cx/(r^10) +  Cxii/(r^12) + Cvii/(r^7) + Cix/(r^9) + Cxi/(r^11)
            VARIABLES r
            PARAMETERS Cvi Cviii Cx Cxii Cvii Cix Cxi
            VALUES 4525.254249630937  858980.4449115618  7.2762912659367565e6  -3.2064841129619866e6  -99340.84352925561  -3.6312235927495877e6  -4.349257632528463e6
            RCUT [angstrom] 9.0
        &amp;END GENPOT

      &amp;END NONBONDED

    &amp;END FORCEFIELD
    &amp;POISSON
      PERIODIC XYZ
      # CP2K needs ewald summation section in input. But for us it is useless,
      # and you can but whatever values here.
      &amp;EWALD
        EWALD_TYPE spme
        ALPHA .44
        GMAX  40
      &amp;END EWALD
    &amp;END POISSON

  &amp;END MM</code></pre><p>Then we make a QM-file with semi-empirical calculation method to condense the system. Here we use AM1-method that is fine for formic acid.</p><pre><code class="language-none">&amp;DFT
    BASIS_SET_FILE_NAME ${LIBDIR}/BASIS_MOLOPT
    POTENTIAL_FILE_NAME ${LIBDIR}/POTENTIAL
    &amp;MGRID
      NGRIDS 4
      CUTOFF 350
      REL_CUTOFF 50
    &amp;END MGRID

    &amp;QS
       # We use semi-empirical to condence the system
       METHOD AM1
       &amp;SE
         &amp;COULOMB
           CUTOFF [angstrom] 10.0
         &amp;END
         &amp;EXCHANGE
           CUTOFF [angstrom] 10.0
         &amp;END
      &amp;END
    &amp;END

    &amp;SCF
      SCF_GUESS ATOMIC
      EPS_SCF 1.0E-6         # convergence threshold for total energy
      MAX_SCF 30
      &amp;OUTER_SCF
        MAX_SCF 10
        EPS_SCF 1.0E-6
      &amp;END
    &amp;END SCF

    # Our QM-box is non periodic, so we need a Poison-solver
    &amp;POISSON
      POISSON_SOLVER MT
      PERIODIC NONE
    &amp;END POISSON

&amp;END DFT
</code></pre><p>and a second file for DFT. We use BLYP-D3BJ here.</p><pre><code class="language-none">&amp;DFT
    BASIS_SET_FILE_NAME ${LIBDIR}/BASIS_MOLOPT
    POTENTIAL_FILE_NAME ${LIBDIR}/POTENTIAL
    &amp;MGRID
      NGRIDS 4
      CUTOFF 350
      REL_CUTOFF 50
    &amp;END MGRID

    &amp;QS
       METHOD GPW
       EPS_DEFAULT 1.0E-10
       EXTRAPOLATION ASPC
    &amp;END


    &amp;SCF
      SCF_GUESS ATOMIC
      EPS_SCF 1.0E-6         # convergence threshold for total energy
      MAX_SCF 30
      &amp;OUTER_SCF
        MAX_SCF 10
        EPS_SCF 1.0E-6
      &amp;END
    &amp;END SCF

    &amp;XC
      &amp;XC_FUNCTIONAL BLYP
      &amp;END XC_FUNCTIONAL
      &amp;VDW_POTENTIAL
         POTENTIAL_TYPE PAIR_POTENTIAL
         &amp;PAIR_POTENTIAL
            TYPE DFTD3(BJ)
            R_CUTOFF 16
            REFERENCE_FUNCTIONAL BLYP
            PARAMETER_FILE_NAME ${LIBDIR}/dftd3.dat
         &amp;END
      &amp;END
    &amp;END XC

    &amp;POISSON
      POISSON_SOLVER MT
      PERIODIC NONE
    &amp;END POISSON

&amp;END DFT</code></pre><p>Then we need to make the QM-MM file</p><pre><code class="language-none">&amp;QMMM
    CENTER_GRID TRUE

    # For formic acid 10Å box is enough
    &amp;CELL                    
      ABC [angstrom] 10 10 10
      PERIODIC NONE
    &amp;END CELL

    # Define QM atoms
    &amp;QM_KIND C
      MM_INDEX 1
    &amp;END QM_KIND
    &amp;QM_KIND O
      MM_INDEX 2 3
    &amp;END QM_KIND
    &amp;QM_KIND H
      MM_INDEX 4 5
    &amp;END QM_KIND

    # Apply periodic potential for MM system (default)
    &amp;PERIODIC
      # We can turn multipole off, because argon has no partial charge
      &amp;MULTIPOLE OFF   
      &amp;END
    &amp;END PERIODIC

&amp;END QMMM</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>CENTER_GRID TRUE</code> is very important option. Without it QM system will heat up on its own and calculations will fail.</p></div></div><p>Finally we make a file that gathers all the other files. The idea here is that you only need to edit this file in the future.</p><pre><code class="language-none">@SET SYSTEM equilib
@SET LIBDIR #add path to cp2k-data directory

&amp;GLOBAL
  PROJECT ${SYSTEM}
  PRINT_LEVEL LOW
  RUN_TYPE MD
&amp;END GLOBAL

&amp;FORCE_EVAL
  STRESS_TENSOR ANALYTICAL
  METHOD QMMM

  # These are the files we created previously
  @include qm-am1.inc
  @include mm.inc
  @include qmmm.inc

  &amp;SUBSYS
    &amp;CELL
      # box containing the system,
      # using 86x86x86 box we made earlier for the inputs
      ABC [angstrom] 86 86 86
    &amp;END CELL
    &amp;TOPOLOGY
      COORD_FILE_NAME tfa-ar.pdb
      COORD_FILE_FORMAT PDB
      CONN_FILE_FORMAT USER
      &amp;GENERATE
         &amp;ISOLATED_ATOMS
            # This need to span to all atoms in the simulation
            # We don&#39;t have any unbreakable mm-bonds in simulation
            LIST 1..1005
         &amp;END
      &amp;END
    &amp;END TOPOLOGY
    &amp;KIND Ho
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q1
      ELEMENT H
    &amp;END KIND
    &amp;KIND H                  
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q1
      ELEMENT H
    &amp;END KIND
    &amp;KIND Hc                 
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q1
      ELEMENT H
    &amp;END KIND
    &amp;KIND Oh
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q6
      ELEMENT O
    &amp;END KIND
    &amp;KIND Oo
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q6
      ELEMENT O
    &amp;END KIND
    &amp;KIND O
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q6
      ELEMENT O
    &amp;END KIND
    &amp;KIND C
      BASIS_SET TZVP-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q4
    &amp;END KIND
  &amp;END SUBSYS

&amp;END FORCE_EVAL

&amp;MOTION

    &amp;MD
        ENSEMBLE NVT
        TEMPERATURE [K] 80
        TEMP_TOL 50
        TIMESTEP [fs] 0.5
        STEPS 20000
        &amp;THERMOSTAT
            REGION MASSIVE
            TYPE CSVR
            &amp;CSVR
              TIMECON [fs] 100
            &amp;END CSVR
        &amp;END THERMOSTAT
    &amp;END MD

    &amp;PRINT
        &amp;TRAJECTORY
            &amp;EACH
                MD 20
            &amp;END EACH
            FORMAT PDB
        &amp;END TRAJECTORY
        &amp;RESTART_HISTORY
            &amp;EACH
                MD 5000
            &amp;END EACH
        &amp;END RESTART_HISTORY
    &amp;END PRINT

&amp;END MOTION
</code></pre><h1 id="Molecular-dynamics-1"><a class="docs-heading-anchor" href="#Molecular-dynamics-1">Molecular dynamics</a><a class="docs-heading-anchor-permalink" href="#Molecular-dynamics-1" title="Permalink"></a></h1><p>Overview here is to start from gas phase and have the system to condense to solid matrix. To do this the simulation consist of 4 phases.</p><ul><li>Equilibration from initial coordinates to some kind of gas.</li><li>Condensing gas solid.</li><li>Changing calculation method from semi-empirical to DFT and equilibrate it.</li><li>Calculate the spectrum.</li></ul><h3 id="The-first-equilibration-1"><a class="docs-heading-anchor" href="#The-first-equilibration-1">The first equilibration</a><a class="docs-heading-anchor-permalink" href="#The-first-equilibration-1" title="Permalink"></a></h3><p>Aim here is to create a super cooled gas that will compress to solid/liquid in the next phase. To do this we need to set simulation temperature to lower than boiling point. For argon 80 K is a good temperature. This can be done with the input file that was constructed earlier.</p><h3 id="Condensing-1"><a class="docs-heading-anchor" href="#Condensing-1">Condensing</a><a class="docs-heading-anchor-permalink" href="#Condensing-1" title="Permalink"></a></h3><p>To condense the system we need to change the dynamics to NTP, so that the external pressure will compress it. To do it we&#39;ll use following input file</p><pre><code class="language-none">@SET SYSTEM condence
@SET LIBDIR # add path to cp2k-data directory

&amp;GLOBAL
  PROJECT ${SYSTEM}
  PRINT_LEVEL LOW
  RUN_TYPE MD
&amp;END GLOBAL

&amp;FORCE_EVAL
  STRESS_TENSOR ANALYTICAL
  METHOD QMMM


  @include qm-am1.inc
  @include mm.inc
  @include qmmm.inc

  @include subsys.inc


&amp;MOTION

    &amp;MD
        ENSEMBLE NPT_I
        TEMPERATURE [K] 20
        TIMESTEP [fs] 0.5
        STEPS 200000
        &amp;THERMOSTAT
            REGION MASSIVE
            TYPE CSVR
            &amp;CSVR
              TIMECON [fs] 250
            &amp;END CSVR
        &amp;END THERMOSTAT
        &amp;BAROSTAT
             PRESSURE [bar] 1.0
             TEMPERATURE [K] 20
             TEMP_TOL [K] 20
             TIMECON [fs] 250
        &amp;END BAROSTAT
    &amp;END MD

    &amp;PRINT
        &amp;TRAJECTORY
            &amp;EACH
                MD 40
            &amp;END EACH
            FORMAT PDB
        &amp;END TRAJECTORY
        &amp;RESTART_HISTORY
            &amp;EACH
                MD 50000
            &amp;END EACH
        &amp;END RESTART_HISTORY
    &amp;END PRINT

&amp;END MOTION</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The rate at which the system condenses is heavily affected by thermostats coupling constant, here 250 fs. The system will condense slower, if the constant is smaller. 250 fs has proven to be a good value for many different systems.</p></div></div><p>This input file has additional file <code>subsys.inc</code> that includes <code>&amp;SUBSYSTEM</code> section form the previous run. You can get the section by using <code>grep</code> on restart file.</p><pre><code class="language-none">grep -A 10000 &quot;&amp;SUBSYS&quot;</code></pre><p>In this phase we also set the final temperature, now 20 K.</p><h3 id="Change-to-DFT-1"><a class="docs-heading-anchor" href="#Change-to-DFT-1">Change to DFT</a><a class="docs-heading-anchor-permalink" href="#Change-to-DFT-1" title="Permalink"></a></h3><p>Next we&#39;ll change QM calculation method to DFT. To do this we&#39;ll use slightly modified input file from the previous phase</p><pre><code class="language-none">@SET SYSTEM dftequilib
@SET LIBDIR # add path to cp2k-data directory

&amp;GLOBAL
  PROJECT ${SYSTEM}
  PRINT_LEVEL LOW
  RUN_TYPE MD
&amp;END GLOBAL

&amp;FORCE_EVAL
  STRESS_TENSOR ANALYTICAL
  METHOD QMMM


  @include qm-blyp-d3bj.inc
  @include mm.inc
  @include qmmm.inc

  @include condensed_subsys.inc


&amp;MOTION

    &amp;MD
        ENSEMBLE NPT_I
        TEMPERATURE [K] 20
        TIMESTEP [fs] 0.5

        # You can increase this if needed
        STEPS 10000
        &amp;THERMOSTAT
            REGION MASSIVE
            TYPE CSVR
            &amp;CSVR
              # This constant is not that important anymore
              TIMECON [fs] 25
            &amp;END CSVR
        &amp;END THERMOSTAT
        &amp;BAROSTAT
             PRESSURE [bar] 1.0
             TEMPERATURE [K] 20
             TEMP_TOL [K] 20
             TIMECON [fs] 250
        &amp;END BAROSTAT
    &amp;END MD

    &amp;PRINT
        &amp;TRAJECTORY
            &amp;EACH
                MD 40
            &amp;END EACH
            FORMAT PDB
        &amp;END TRAJECTORY
        &amp;RESTART_HISTORY
            &amp;EACH
                MD 5000
            &amp;END EACH
        &amp;END RESTART_HISTORY
    &amp;END PRINT

&amp;END MOTION</code></pre><h2 id="IR-spectrum-calculation-1"><a class="docs-heading-anchor" href="#IR-spectrum-calculation-1">IR spectrum calculation</a><a class="docs-heading-anchor-permalink" href="#IR-spectrum-calculation-1" title="Permalink"></a></h2><p>To calculate spectrum we need dipole moments, to do this we need to add command to print them to our QM-file</p><pre><code class="language-none">&amp;DFT
    BASIS_SET_FILE_NAME ${LIBDIR}/BASIS_MOLOPT
    POTENTIAL_FILE_NAME ${LIBDIR}/POTENTIAL
    &amp;MGRID
      NGRIDS 4
      CUTOFF 350
      REL_CUTOFF 50
    &amp;END MGRID

    &amp;QS
       METHOD GPW
       EPS_DEFAULT 1.0E-10
       EXTRAPOLATION ASPC
    &amp;END


    &amp;SCF
      SCF_GUESS ATOMIC
      EPS_SCF 1.0E-6         # convergence threshold for total energy
      MAX_SCF 30
      &amp;OUTER_SCF
        MAX_SCF 10
        EPS_SCF 1.0E-6
      &amp;END
    &amp;END SCF

    &amp;XC
      &amp;XC_FUNCTIONAL BLYP
      &amp;END XC_FUNCTIONAL
      &amp;VDW_POTENTIAL
         POTENTIAL_TYPE PAIR_POTENTIAL
         &amp;PAIR_POTENTIAL
            TYPE DFTD3(BJ)
            R_CUTOFF 16
            REFERENCE_FUNCTIONAL BLYP
            PARAMETER_FILE_NAME ${LIBDIR}/dftd3.dat
         &amp;END
      &amp;END
    &amp;END XC

    &amp;POISSON
      POISSON_SOLVER MT
      PERIODIC NONE
    &amp;END POISSON

    &amp;PRINT
      &amp;MOMENTS
       PERIODIC FALSE
       &amp;EACH
         MD 1
       &amp;END
       MAX_MOMENT 1
       FILENAME =dipole.traj
      &amp;END MOMENTS
     &amp;END

&amp;END DFT</code></pre><p>We&#39;ll also need to edit input file to change the mode to NVE</p><pre><code class="language-none">@SET SYSTEM spectrum
@SET LIBDIR # add path to cp2k-data directory

&amp;GLOBAL
  PROJECT ${SYSTEM}
  PRINT_LEVEL LOW
  RUN_TYPE MD
&amp;END GLOBAL

&amp;FORCE_EVAL
  STRESS_TENSOR ANALYTICAL
  METHOD QMMM


  @include qm-blyp-d3bj-dipoles.inc
  @include mm.inc
  @include qmmm.inc

  @include dft_subsys.inc


&amp;MOTION

    &amp;MD
        ENSEMBLE NVE
        TIMESTEP [fs] 0.5
        STEPS 80000
    &amp;END MD

    &amp;PRINT
        &amp;TRAJECTORY
            &amp;EACH
                MD 5
            &amp;END EACH
            FORMAT PDB
        &amp;END TRAJECTORY
        &amp;RESTART_HISTORY
            &amp;EACH
                MD 5000
            &amp;END EACH
        &amp;END RESTART_HISTORY
    &amp;END PRINT

&amp;END MOTION</code></pre><p>This will create <code>dipole.traj</code>-file that contains dipole moments. You can use <a href="https://github.com/MatrixLabTools/IRSpectrum.jl">IRSpectrum.jl</a> to calculate IR-spectrum form the dipole trajectory file.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../use/">« Fitting Potential</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 28 January 2020 19:53">Tuesday 28 January 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
